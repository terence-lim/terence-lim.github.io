<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>finds package &mdash; Financial Data Science 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="finds" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Financial Data Science
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">finds</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">finds package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.backtesting">finds.backtesting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.busday">finds.busday module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.database">finds.database module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.pyR">finds.pyR module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.recipes">finds.recipes module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds.structured">finds.structured module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-finds">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Financial Data Science</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">finds</a> &raquo;</li>
      <li>finds package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/finds.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="finds-package">
<h1>finds package<a class="headerlink" href="#finds-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-finds.backtesting">
<span id="finds-backtesting-module"></span><h2>finds.backtesting module<a class="headerlink" href="#module-finds.backtesting" title="Permalink to this heading"></a></h2>
<p>Evaluate backtests, event studies and risk premiums</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Event studies, cumulative abnormal returns</p></li>
<li><p>Risk premiums, Fama-MacBeth regressions</p></li>
<li><p>Sharpe ratio, appraisal ratio, walk-forward backtests</p></li>
</ul>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
</section>
<section id="module-finds.busday">
<span id="finds-busday-module"></span><h2>finds.busday module<a class="headerlink" href="#module-finds.busday" title="Permalink to this heading"></a></h2>
<p>Implement custom trading-day business date calendar</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Create trading day and weekly calendars from 1925 to present.</p></li>
<li><p>Construct rebalance dates and holdings periods on valid trading days
for daily, weekly, month and annual frequencies.</p></li>
<li><p>Convert between Pandas TimeStamp, python datetime, and custom calendar.</p></li>
<li><p>Uses Pandas and Numpy busdaycalendar and offsets</p></li>
</ul>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="finds.busday.BusDay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.busday.</span></span><span class="sig-name descname"><span class="pre">BusDay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">19251231</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20221231</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.busday.BusDay" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implement custom business/trading dates calendar</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – SQL connection instance to store dates</p></li>
<li><p><strong>start</strong> – Start date calendar</p></li>
<li><p><strong>end</strong> – End date of calendar</p></li>
<li><p><strong>new</strong> – Recreate from Ken French library datareader, else retrieve SQL</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Non-trading holidays inferred from Ken French and NYSE websites</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Convert int date or pandas timestamp to pydatetime type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – Input date or year or pandas Timestamp or datetime64</p></li>
<li><p><strong>month</strong> – If None, then month is inferred from input date</p></li>
<li><p><strong>day</strong> – If None, then day is inferred from input date</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>datetime object or list-like with same shape as input date</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>If input DD is 00, then returns custom business month begin date</p></li>
<li><p>If input DD is 99, then returns custom business month end date</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.begmo">
<span class="sig-name descname"><span class="pre">begmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.begmo" title="Permalink to this definition"></a></dt>
<dd><p>Return (list of) business month begin date, optional months offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.begyr">
<span class="sig-name descname"><span class="pre">begyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.begyr" title="Permalink to this definition"></a></dt>
<dd><p>Return (list of) business year begin date, optional years offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.date_range">
<span class="sig-name descname"><span class="pre">date_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'daily'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.date_range" title="Permalink to this definition"></a></dt>
<dd><p>Return business dates at desired freq between beg and end dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Inclusive start of date range</p></li>
<li><p><strong>end</strong> – Inclusive end of date range</p></li>
<li><p><strong>freq</strong> – {‘daily’, ‘begmo’, ‘endmo’, int month}
If int, then annual ending on month-end business date</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.date_tuples">
<span class="sig-name descname"><span class="pre">date_tuples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.date_tuples" title="Permalink to this definition"></a></dt>
<dd><p>Return (beg, end) holding period between rebalance dates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.day">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">day</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.day" title="Permalink to this definition"></a></dt>
<dd><p>Helper to extract day of month from input date or list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.december_fiscal">
<span class="sig-name descname"><span class="pre">december_fiscal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.december_fiscal" title="Permalink to this definition"></a></dt>
<dd><p>Return lagged December fiscal year-end date, per FamaFrench-specs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.endmo">
<span class="sig-name descname"><span class="pre">endmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.endmo" title="Permalink to this definition"></a></dt>
<dd><p>Return (list of) business month end date, optional months offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.endyr">
<span class="sig-name descname"><span class="pre">endyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.endyr" title="Permalink to this definition"></a></dt>
<dd><p>Return (list of) business year end date, optional years offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.june_universe">
<span class="sig-name descname"><span class="pre">june_universe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.june_universe" title="Permalink to this definition"></a></dt>
<dd><p>Return prior June universe selection date, per FamaFrench specs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.month">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.month" title="Permalink to this definition"></a></dt>
<dd><p>Helper to extract month from input date or list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'preceding'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.offset" title="Permalink to this definition"></a></dt>
<dd><p>Return valid business date with optional offset or roll treatment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> – Input dates in YYYYMMDD int format</p></li>
<li><p><strong>offsets</strong> – Number of business days to offset</p></li>
<li><p><strong>end</strong> – End index of offset window, None to return a single date</p></li>
<li><p><strong>roll</strong> – {‘raise’, ‘forward’, ‘following’, ‘backward’, ‘preceding’}
How to treat dates that are not a valid day</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.BusDay.year">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.BusDay.year" title="Permalink to this definition"></a></dt>
<dd><p>Helper to extract year from input date or list</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.busday.</span></span><span class="sig-name descname"><span class="pre">WeeklyDay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">19251231</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20401231</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.busday.WeeklyDay" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><code class="xref py py-class docutils literal notranslate"><span class="pre">BusDay</span></code></a></p>
<p>Generate custom weekly trading date calendar, ending on any day-of-week</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – SQL connection instance</p></li>
<li><p><strong>day</strong> – [‘Sun’,’Mon’,’Tue’,’Wed’,’Thu’,’Fri’,’Sat’] or [0,…,7]</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay.weeks">
<span class="sig-name descname"><span class="pre">weeks</span></span><a class="headerlink" href="#finds.busday.WeeklyDay.weeks" title="Permalink to this definition"></a></dt>
<dd><p>DataFrame of weeks in rows, index is weeknum and
columns for beg, end dates and ismonthend</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay.begwk">
<span class="sig-name descname"><span class="pre">begwk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">typing.Union[int,</span> <span class="pre">typing.List[int]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weeks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.WeeklyDay.begwk" title="Permalink to this definition"></a></dt>
<dd><p>Return beginning business week dates, with optional offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay.date_range">
<span class="sig-name descname"><span class="pre">date_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'weekly'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.WeeklyDay.date_range" title="Permalink to this definition"></a></dt>
<dd><p>Return weekly ending trading dates within start and end range</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay.endwk">
<span class="sig-name descname"><span class="pre">endwk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">typing.Union[int,</span> <span class="pre">typing.List[int]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weeks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.WeeklyDay.endwk" title="Permalink to this definition"></a></dt>
<dd><p>Return ending business week dates, with optional offset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.busday.WeeklyDay.ismonthend">
<span class="sig-name descname"><span class="pre">ismonthend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.WeeklyDay.ismonthend" title="Permalink to this definition"></a></dt>
<dd><p>If dates is in last complete week in a month</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.busday.to_date">
<span class="sig-prename descclassname"><span class="pre">finds.busday.</span></span><span class="sig-name descname"><span class="pre">to_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">informat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y-%m-%d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outformat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y%m%d'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.to_date" title="Permalink to this definition"></a></dt>
<dd><p>Construct int date from strings using input and output formats</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – Input date strings or Timestamp or pydatetime to convert</p></li>
<li><p><strong>informat</strong> – Optional format of input date string</p></li>
<li><p><strong>outformat</strong> – Format of output int date</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>int dates with year, month, date components according to outformat</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>to_date and (pandas) to_datetime are all you need</p></li>
<li><dl class="simple">
<dt>Formats specified as in strptime() and strftime():</dt><dd><ul>
<li><p>%b %B %h = input month name</p></li>
<li><p>%F = %Y-%m-%d</p></li>
<li><p>%T = %H:%M:%S</p></li>
<li><p>%n = whitespace</p></li>
<li><p>%w %W %U %V = week number</p></li>
<li><p>%u = day of week (1-7)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_date</span><span class="p">(</span><span class="s1">&#39;12-31-1999&#39;</span><span class="p">,</span> <span class="n">informat</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_date</span><span class="p">([</span><span class="s1">&#39;1999-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;1999-12-31&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">19991231</span><span class="p">),</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.busday.to_monthend">
<span class="sig-prename descclassname"><span class="pre">finds.busday.</span></span><span class="sig-name descname"><span class="pre">to_monthend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.busday.to_monthend" title="Permalink to this definition"></a></dt>
<dd><p>Return calendar monthend date given an int date or list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dates</strong> – input YYYYMMDD (or first 4-, 6-digits) int date, or list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output dates converted to monthend of calendar</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finds.database">
<span id="finds-database-module"></span><h2>finds.database module<a class="headerlink" href="#module-finds.database" title="Permalink to this heading"></a></h2>
<p>Implement wrappers for database engines</p>
<p>Wrappers for connecting to SQL, MongoDB and Redis.
Convenience methods for pandas DataFrames to match SQL
database schemas for loading, storing and pivoting;
and serialize to Redis store.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>SQL: sqlalchemy</p></li>
<li><p>MongoDB: pymongo</p></li>
<li><p>NoSQL key-value store: redis</p></li>
</ul>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="finds.database.MongoDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.database.</span></span><span class="sig-name descname"><span class="pre">MongoDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">27017</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.MongoDB" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides convenience interface to pymongo database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – str
Name of database in MongoDB</p></li>
<li><p><strong>host</strong> – str
IP address of server</p></li>
<li><p><strong>port</strong> – int
Port number</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finds.database.MongoDB.client">
<span class="sig-name descname"><span class="pre">client</span></span><a class="headerlink" href="#finds.database.MongoDB.client" title="Permalink to this definition"></a></dt>
<dd><p>MongoClient object providing MongoDB interface</p>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdb</span> <span class="o">=</span> <span class="n">MongoDB</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serverStatusResult</span> <span class="o">=</span> <span class="n">mdb</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">admin</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;serverStatus&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">serverStatusResult</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collections</span> <span class="o">=</span> <span class="n">mdb</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdb</span><span class="o">.</span><span class="n">client</span><span class="p">[</span><span class="n">database</span><span class="p">][</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">estimated_document_count</span><span class="p">()</span>
</pre></div>
</div>
<p>Pymongo methods for a collection object:</p>
<ul class="simple">
<li><p>count_documents(self, filter, session=None, limit=None)</p></li>
<li><p>create_index(self, keys, unique=False)</p></li>
<li><p>create_indexes(self, indexes)</p></li>
<li><p>delete_one(self, filter)</p></li>
<li><p>distinct(self, key, filter=None)</p></li>
<li><p>drop(self)</p></li>
<li><p>drop_index(self, index_or_name)</p></li>
<li><p>drop_indexes(self)</p></li>
<li><p>estimated_document_count(self)</p></li>
<li><p>find(self, filter={}, projection=[], limit=None)</p></li>
<li><p>find_one(self, filter=None)</p></li>
<li><p>insert_many(self, documents, ordered=True)</p></li>
<li><p>insert_one(self, document)</p></li>
<li><p>list_indexes(self)</p></li>
<li><p>replace_one(self, filter, replacement, upsert=False)</p></li>
<li><p>update_many(self, filter, update, upsert=False)</p></li>
<li><p>update_many(self, filter, update, upsert=False)</p></li>
<li><p>update_one(self, filter, update, upsert=False)</p></li>
</ul>
<p>Operators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$eq      Matches values that are equal to a specified value.
$gt      Matches values that are greater than a specified value.
$gte     Matches values that are greater than or equal to a specified value.
$in      Matches any of the values specified in an array.
$lt      Matches values that are less than a specified value.
$lte     Matches values that are less than or equal to a specified value.
$ne      Matches all values that are not equal to a specified value.
$nin     Matches none of the values specified in an array.
$and     Joins query clauses with a logical AND
$not     Inverts the effect of a query expression
$nor     Joins query clauses with a logical NOR returns
$or      Joins query clauses with a logical OR returns
$exists  Matches documents that have the specified field.
$type    Selects documents if a field is of the specified type.
</pre></div>
</div>
<p>Unix Installation:</p>
<p><a class="reference external" href="https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-ubuntu/">https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-ubuntu/</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">mongod</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">mongod</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">stop</span> <span class="n">mongod</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">mongod</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">mongod</span> <span class="n">stop</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">*</span>
</pre></div>
</div>
<p>/etc/mongod.conf - configuration file for MongoDB:</p>
<ul class="simple">
<li><p>dbPath -  where the database files stored (/var/lib/mongodb)</p></li>
<li><p>systemLog - logging options (/var/log/mongodb/mongod.log)</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="finds.database.MongoDB.drop">
<span class="sig-name descname"><span class="pre">drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.MongoDB.drop" title="Permalink to this definition"></a></dt>
<dd><p>Drop a database or collection (i.e. table) by name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.MongoDB.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.MongoDB.show" title="Permalink to this definition"></a></dt>
<dd><p>List all database or collection (i.e. table) names</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.database.Redis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.database.</span></span><span class="sig-name descname"><span class="pre">Redis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.Redis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provide DataFrames interface with parquet to redis key-value store</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Arguments for initializing redis.StrictRedis constructor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>r.delete(key)      – delete an item</p></li>
<li><p>r.get(key)         – get an item</p></li>
<li><p>r.exists(key)      – does item exist</p></li>
<li><p>r.set(key, value)  – set an item</p></li>
<li><p>r.keys()           – get keys</p></li>
<li><p>decode_responses=False to zlib dataframe</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./redis-5.0.4/src/redis-server
$ ./redis-cli --scan --pattern &#39;*CRSP_2020*&#39; | xargs ./redis-cli del
CLI&gt; keys *
CLI&gt; flushall
CLI&gt; info memory
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="finds.database.Redis.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.Redis.dump" title="Permalink to this definition"></a></dt>
<dd><p>Saves dataframe, serialized to parquet, by key name to redis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.Redis.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.Redis.load" title="Permalink to this definition"></a></dt>
<dd><p>Return and deserialize dataframe given its key from redis store</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.database.SQL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.database.</span></span><span class="sig-name descname"><span class="pre">SQL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'3306'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocommit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'true'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'utf8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'temp7771'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provide convenience interface to sqlalchemy engine</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.Index">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Index</span></span></span><a class="headerlink" href="#finds.database.SQL.Index" title="Permalink to this definition"></a></dt>
<dd><p>Wrap sqlalchemy.Index(), auto-generates index name from args</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.Table">
<span class="sig-name descname"><span class="pre">Table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="headerlink" href="#finds.database.SQL.Table" title="Permalink to this definition"></a></dt>
<dd><p>Wrap sqlalchemy.Table() to first remove table entry from metadata</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.create_engine">
<span class="sig-name descname"><span class="pre">create_engine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.create_engine" title="Permalink to this definition"></a></dt>
<dd><p>Wrap sqlalchemy.create_engine() and MetaData(); store attributes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.load_dataframe">
<span class="sig-name descname"><span class="pre">load_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.load_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Load dataframe into sql table, ignoring duplicate primary keys</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – Physical name of table to insert into</p></li>
<li><p><strong>df</strong> – Source dataframe</p></li>
<li><p><strong>index_label</strong> – Column name to load index as, None (default) to ignore</p></li>
<li><p><strong>to_sql</strong> – first attempt pandas.to_sql(), which may fail if duplicate
keys; then/else insert ignore from temp table instead.</p></li>
<li><p><strong>replace</strong> – set True to overwrite table, else append (default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.load_infile">
<span class="sig-name descname"><span class="pre">load_infile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csvfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.load_infile" title="Permalink to this definition"></a></dt>
<dd><p>Load table from csv file, using mysql’s load data local infile</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.pivot">
<span class="sig-name descname"><span class="pre">pivot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.database.SQL.pivot" title="Permalink to this definition"></a></dt>
<dd><p>Return sql query result as pivoted data frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – Physical name of table to retrieve from</p></li>
<li><p><strong>index</strong> – Field name to select as dataframe index</p></li>
<li><p><strong>columns</strong> – Field name to select as column labels</p></li>
<li><p><strong>values</strong> – Field name to select as values</p></li>
<li><p><strong>where</strong> – Where clause, optional</p></li>
<li><p><strong>limit</strong> – Maximum optional number of rows or chunks to return</p></li>
<li><p><strong>chunksize</strong> – To optionally buildup results in chunks of this size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Query result as a pivoted (wide) DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.print" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.read_dataframe">
<span class="sig-name descname"><span class="pre">read_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.read_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Return sql query result as data frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>q</strong> – query string or SQLAlchemy Selectable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of results</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – Failed to run query</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.database.SQL.remove" title="Permalink to this definition"></a></dt>
<dd><p>Remove a table, by its key name, from metadata instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.database.SQL.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute an sql command</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – query string</p></li>
<li><p><strong>*args</strong> – argument list for query</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments for query</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result set {‘data’, ‘columns’}, or None.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – failed to run query</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;show databases&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;show tables&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;select * from testing&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;select distinct permno from benchmarks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;show create table _&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;describe _&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;truncate table _&quot;</span><span class="p">,</span> <span class="n">fetch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.database.SQL.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.database.SQL.summary" title="Permalink to this definition"></a></dt>
<dd><p>Return summary statistics for a field, optionally grouped-by</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – Physical name of table</p></li>
<li><p><strong>val</strong> – Field name to summarise</p></li>
<li><p><strong>key</strong> – Field to group by</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame with columns (count, average, max, min)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="s1">&#39;annual&#39;</span><span class="p">,</span> <span class="s1">&#39;revt&#39;</span><span class="p">,</span> <span class="s1">&#39;sic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-finds.pyR">
<span id="finds-pyr-module"></span><h2>finds.pyR module<a class="headerlink" href="#module-finds.pyR" title="Permalink to this heading"></a></h2>
<p>Class to wrap over rpy2 package to interface with R environment</p>
<p>Expose arbitrary object as rpy2 or numpy/pandas object</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="finds.pyR.PyR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.pyR.</span></span><span class="sig-name descname"><span class="pre">PyR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.PyR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Store and expose as rpy2 or numpy/pandas objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>rpy2 R Object</em><em>, or </em><em>Python numpy.array-compatible</em>) – input object</p></li>
<li><p><strong>names</strong> (<em>StrVector</em><em>, </em><em>ListVector</em><em>, </em><em>str</em><em> or </em><em>list of str</em>) – labels, if any</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finds.pyR.PyR.iloc">
<span class="sig-name descname"><span class="pre">iloc</span></span><a class="headerlink" href="#finds.pyR.PyR.iloc" title="Permalink to this definition"></a></dt>
<dd><p>dict or numpy array
internally, objects are stored as either numpy array,
or dict of objects (when input was R ListVector or DataFrame,
or Python dict).
Should use other safer property getters to view object in target types:
e,g, .frame (pandas), .ro (RObject), or .values (python dict or ndarray)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finds.pyR.PyR.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#finds.pyR.PyR.dim" title="Permalink to this definition"></a></dt>
<dd><p>tuple of int
dimensions of data objects</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">names,</span> <span class="pre">rownames,</span> <span class="pre">colnames</span></span></dt>
<dd><p>StrVector</p>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>input item can be of either Python or R object type</p></li>
<li><p>input labels in each dimension can be explicitly provide, should have
same dim as object, error checking is minimal</p></li>
<li><p>In R, matrices are column-major ordered (aka Fortran-like index order,
with the first index changing fastest) although the R constructor
matrix() accepts a boolean argument byrow that, when true, will build
the matrix as if row-major ordered (aka C-like, which is also Python numpy
default order, where the last axis index changes fastest)</p></li>
<li><p>A suggested convention is to append ‘_’ to R function names and
‘_r’ to R objects, and capitalize initial letter of PyR instances.</p></li>
<li><p>r[‘plot’] may need to explicitliy set xlab=’’, ylab=’’</p></li>
</ul>
<p>TODO: if hasattri(‘slots’), particulary ‘ts’ class, e.g. nile.slots.items()</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rpy2.robjects</span> <span class="kn">import</span> <span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rpy2.robjects.packages</span> <span class="kn">import</span> <span class="n">importr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amen_r</span> <span class="o">=</span> <span class="n">importr</span><span class="p">(</span><span class="s1">&#39;amen&#39;</span><span class="p">)</span>                      <span class="c1"># use R library</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>                                   <span class="c1"># link R routines</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nodevars</span> <span class="o">=</span> <span class="n">PyR</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;IR90s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rx2</span><span class="p">[</span><span class="s1">&#39;nodevars&#39;</span><span class="p">])</span>    <span class="c1"># retrieve R data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Gdp</span> <span class="o">=</span> <span class="n">Nodevars</span><span class="p">[:,</span> <span class="s1">&#39;gdp&#39;</span><span class="p">]</span>                      <span class="c1"># getitem subset with slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topgdp</span> <span class="o">=</span> <span class="n">Gdp</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Gdp</span><span class="o">.</span><span class="n">py</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">30</span><span class="p">]</span> <span class="c1"># python calcs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dyadvars</span> <span class="o">=</span> <span class="n">PyR</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;IR90s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rx2</span><span class="p">[</span><span class="s1">&#39;dyadvars&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Dyadvars</span><span class="p">[</span><span class="n">topgdp</span><span class="p">,</span> <span class="n">topgdp</span><span class="p">,</span> <span class="s1">&#39;exports&#39;</span><span class="p">]</span>  <span class="c1"># getitem with boolean index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="o">.</span><span class="n">iloc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">iloc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>          <span class="c1"># update with python calculations</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="finds.pyR.PyR.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.PyR.__getitem__" title="Permalink to this definition"></a></dt>
<dd><p>Returns copy of subset of data object from given slice or index</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.pyR.PyR.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.PyR.assign" title="Permalink to this definition"></a></dt>
<dd><p>Directly update internal data object (must be same numpy shape)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finds.pyR.PyR.frame">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frame</span></span><a class="headerlink" href="#finds.pyR.PyR.frame" title="Permalink to this definition"></a></dt>
<dd><p>Expose a view as pandas DataFrame</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.pyR.PyR.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.PyR.index" title="Permalink to this definition"></a></dt>
<dd><p>Helper method to lookup index/es of (list of) str label in names</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finds.pyR.PyR.ncol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncol</span></span><a class="headerlink" href="#finds.pyR.PyR.ncol" title="Permalink to this definition"></a></dt>
<dd><p>Length of second dimension, as R IntVector type</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finds.pyR.PyR.nrow">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nrow</span></span><a class="headerlink" href="#finds.pyR.PyR.nrow" title="Permalink to this definition"></a></dt>
<dd><p>Length of first dimension, as R IntVector type</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finds.pyR.PyR.ro">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ro</span></span><a class="headerlink" href="#finds.pyR.PyR.ro" title="Permalink to this definition"></a></dt>
<dd><p>Expose a view as RObject, can be passed to R environment</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.pyR.PyR.savefig">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">savefig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">12)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.PyR.savefig" title="Permalink to this definition"></a></dt>
<dd><p>Save R graphics to file, or return R command. Optionally imshow</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="finds.pyR.PyR.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#finds.pyR.PyR.values" title="Permalink to this definition"></a></dt>
<dd><p>Expose view as python dict (when ListVector) or ndarray (when not)</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.pyR.StrListVector">
<span class="sig-prename descclassname"><span class="pre">finds.pyR.</span></span><span class="sig-name descname"><span class="pre">StrListVector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strList</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.StrListVector" title="Permalink to this definition"></a></dt>
<dd><p>Convert each level of input, recursively, to a StrVector or a ListVector</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.pyR.combine">
<span class="sig-prename descclassname"><span class="pre">finds.pyR.</span></span><span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.combine" title="Permalink to this definition"></a></dt>
<dd><p>Flatten each arg, and concat all into a flat list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.pyR.flatten">
<span class="sig-prename descclassname"><span class="pre">finds.pyR.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.pyR.flatten" title="Permalink to this definition"></a></dt>
<dd><p>Generator returns each terminal item (by DFS) from nested list</p>
</dd></dl>

</section>
<section id="module-finds.recipes">
<span id="finds-recipes-module"></span><h2>finds.recipes module<a class="headerlink" href="#module-finds.recipes" title="Permalink to this heading"></a></h2>
<p>Utility recipes</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>linear algebra, stationarity, robust covariances</p></li>
<li><p>maturity, bootstrap, annuity, compounding, rate of discount and interest</p></li>
<li><p>value at risk, duration, half-life</p></li>
</ul>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="finds.recipes.fractiles">
<span class="sig-prename descclassname"><span class="pre">finds.recipes.</span></span><span class="sig-name descname"><span class="pre">fractiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.recipes.fractiles" title="Permalink to this definition"></a></dt>
<dd><p>Sort and assign values into fractiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – input array to assign to fractiles</p></li>
<li><p><strong>pct</strong> – list of percentiles 0..100</p></li>
<li><p><strong>keys</strong> – key values to determine breakpoints, use values if None</p></li>
<li><p><strong>ascending</strong> – if True, assign to fractiles in ascending order</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of fractile assignments {1,.., len(pct)} s.t. value &lt;= pctile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.recipes.fstats">
<span class="sig-prename descclassname"><span class="pre">finds.recipes.</span></span><span class="sig-name descname"><span class="pre">fstats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.recipes.fstats" title="Permalink to this definition"></a></dt>
<dd><p>Helper to compute F-stats at all candidate break points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.recipes.lm">
<span class="sig-prename descclassname"><span class="pre">finds.recipes.</span></span><span class="sig-name descname"><span class="pre">lm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">NamedTuple</span></span></span><a class="headerlink" href="#finds.recipes.lm" title="Permalink to this definition"></a></dt>
<dd><p>Calculate linear multiple regression model results as namedtuple</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>DataFrame</em><em>, </em><em>Series</em>) – RHS independent variables</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>DataFrame</em><em>, </em><em>Series</em>) – LHS dependent variables</p></li>
<li><p><strong>add_constant</strong> – hstack ‘Intercept’ column of ones before x variables</p></li>
<li><p><strong>flatten</strong> – flatten computed results to 1-dimensional before return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>LinearModel named tuple, with key and values</dt><dd><p>coefficients: estimated linear regression coefficients
fitted: fitted y values
residuals: fitted - actual y values
rsq: R-squared
rvalue: square root of r-squared
stderr: std dev of residuals</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-finds.structured">
<span id="finds-structured-module"></span><h2>finds.structured module<a class="headerlink" href="#module-finds.structured" title="Permalink to this heading"></a></h2>
<p>Implements interface for structured data sets</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>CRSP including delistings, distributions, and shares outstanding</p></li>
<li><p>Compustat</p></li>
<li><p>IBES</p></li>
</ul>
<dl class="simple">
<dt>Author:</dt><dd><p>Terence Lim</p>
</dd>
<dt>License:</dt><dd><p>MIT</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Benchmarks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">Benchmarks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Benchmarks" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stocks</span></code></a></p>
<p>Provide Structured Stocks interface to benchmark and index returns</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Benchmarks.load_series">
<span class="sig-name descname"><span class="pre">load_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Benchmarks.load_series" title="Permalink to this definition"></a></dt>
<dd><p>Loads a Series containing benchmark returns to sql</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame with time-series in each column to load to sql</p></li>
<li><p><strong>name</strong> – Primary label for this source to insert into ident table</p></li>
<li><p><strong>item</strong> – Secondary label for this source to insert into ident table</p></li>
<li><p><strong>monthly</strong> – if True: convert index to business calendar endmo dates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of identifiers metadata for series successfully loaded</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Each column of input data frame is loaded to sql table ‘daily’,
with its series name as ‘permno’ field, values as ‘ret’ field,
and series index as ‘date’ field.</p></li>
<li><p>‘idents’ table in sql is also updated with identifier and metadata</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.CRSP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">CRSP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#finds.database.Redis" title="finds.database.Redis"><span class="pre">Redis</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.CRSP" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stocks</span></code></a></p>
<p>Implements an interface to CRSP structured stocks datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – Connection to mysql database</p></li>
<li><p><strong>dates</strong> – Business dates object</p></li>
<li><p><strong>rdb</strong> – Optional connection to Redis for caching selected query results</p></li>
</ul>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Earliest CRSP prc 19251231, FF 19260701 (except STRev daily 19260126)</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.build_lookup">
<span class="sig-name descname"><span class="pre">build_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#finds.structured.CRSP.build_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Build lookup function to return target identifier from source</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.get_cap">
<span class="sig-name descname"><span class="pre">get_cap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_daily</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_permco</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.CRSP.get_cap" title="Permalink to this definition"></a></dt>
<dd><p>Compute a cross-section of market capitalization values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – YYYYMMDD int date of market cap</p></li>
<li><p><strong>use_cache</strong> – Is True, then both read and write cache; if False, then
write but not read cache; If None, then ignore cache</p></li>
<li><p><strong>use_daily</strong> – If True, use shrout from ‘daily’ table, else ‘shares’</p></li>
<li><p><strong>use_permco</strong> – If True, sum caps by permco, else by permno</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of market cap indexed by permno</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.get_divamt">
<span class="sig-name descname"><span class="pre">get_divamt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.CRSP.get_divamt" title="Permalink to this definition"></a></dt>
<dd><p>Accmumulates total dollar dividends between start and end dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Inclusive start date (YYYYMMDD)</p></li>
<li><p><strong>end</strong> – Inclusive end date (YYYYMMDD)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame with accumulated divamts = per share divamt * shrout</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.get_dlstret">
<span class="sig-name descname"><span class="pre">get_dlstret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.CRSP.get_dlstret" title="Permalink to this definition"></a></dt>
<dd><p>Compounded delisting returns from start to end dates for all permnos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Inclusive start date (YYYYMMDD)</p></li>
<li><p><strong>end</strong> – Inclusive end date (YYYYMMDD)</p></li>
<li><p><strong>use_cache</strong> – If True, then read and write cache; if False, then
write but not read cache; If None then ignore cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of compounded returns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.get_ret">
<span class="sig-name descname"><span class="pre">get_ret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.CRSP.get_ret" title="Permalink to this definition"></a></dt>
<dd><p>Get compounded returns, with option to include delist returns</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.CRSP.get_universe">
<span class="sig-name descname"><span class="pre">get_universe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minprc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.CRSP.get_universe" title="Permalink to this definition"></a></dt>
<dd><p>Return standard CRSP universe of US-domiciled common stocks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – Rebalance date (YYYYMMDD)</p></li>
<li><p><strong>minprc</strong> – Minimum share price filter</p></li>
<li><p><strong>use_cache</strong> – If True, then read and write cache; if False, then
write but not read cache; If None then ignore cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>market cap “decile” (1..10), “nyse” bool, “siccd”, “prc”, “cap”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame of screened universe, indexed by permno, with columns</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Market cap must be available on date, with prc &gt; 0.0</p></li>
<li><p>shrcd in [10, 11], exchcd in [1, 2, 3]</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.FamaFrench">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">FamaFrench</span></span><a class="headerlink" href="#finds.structured.FamaFrench" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class wraps over pandas_datareader to retrieve FamaFrench factors</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="finds.structured.FamaFrench.datasets">
<span class="sig-name descname"><span class="pre">datasets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('F-F_Research_Data_5_Factors_2x3_daily',</span> <span class="pre">0,</span> <span class="pre">''),</span> <span class="pre">('F-F_Research_Data_5_Factors_2x3',</span> <span class="pre">0,</span> <span class="pre">'(mo)'),</span> <span class="pre">('F-F_Research_Data_Factors_daily',</span> <span class="pre">0,</span> <span class="pre">''),</span> <span class="pre">('F-F_Research_Data_Factors',</span> <span class="pre">0,</span> <span class="pre">'(mo)'),</span> <span class="pre">('F-F_Momentum_Factor_daily',</span> <span class="pre">0,</span> <span class="pre">''),</span> <span class="pre">('F-F_Momentum_Factor',</span> <span class="pre">0,</span> <span class="pre">'(mo)'),</span> <span class="pre">('F-F_LT_Reversal_Factor_daily',</span> <span class="pre">0,</span> <span class="pre">''),</span> <span class="pre">('F-F_LT_Reversal_Factor',</span> <span class="pre">0,</span> <span class="pre">'(mo)'),</span> <span class="pre">('F-F_ST_Reversal_Factor_daily',</span> <span class="pre">0,</span> <span class="pre">''),</span> <span class="pre">('F-F_ST_Reversal_Factor',</span> <span class="pre">0,</span> <span class="pre">'(mo)'),</span> <span class="pre">('49_Industry_Portfolios_daily',</span> <span class="pre">0,</span> <span class="pre">'49vw'),</span> <span class="pre">('48_Industry_Portfolios_daily',</span> <span class="pre">0,</span> <span class="pre">'48vw'),</span> <span class="pre">('49_Industry_Portfolios_daily',</span> <span class="pre">1,</span> <span class="pre">'49ew'),</span> <span class="pre">('48_Industry_Portfolios_daily',</span> <span class="pre">1,</span> <span class="pre">'48ew')]</span></em><a class="headerlink" href="#finds.structured.FamaFrench.datasets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.FamaFrench.fetch">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">19260101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20271231</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_formatter=&lt;function</span> <span class="pre">FamaFrench.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.FamaFrench.fetch" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve item and return as DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of research factor in Ken French website</p></li>
<li><p><strong>item</strong> – Index of item to research (e.g. 0 is usually value-weighted)</p></li>
<li><p><strong>suffix</strong> – Suffix string to append to name when stored in sql</p></li>
<li><p><strong>start</strong> – earliest date to retrieve</p></li>
<li><p><strong>end</strong> – latest date to retrieve</p></li>
<li><p><strong>date_formatter</strong> – to reformat dates, e.g. BD.offset or BD.endmo</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Finder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">Finder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Finder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Builds a class to lookup identifiers from multiple datasets</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Finder.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Finder.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Lookup by an identifier str.</p>
<p>Guesses identifier type and table if not specified or initialized</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ALPHABET&#39;</span><span class="p">,</span> <span class="s1">&#39;comnam&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ALPHABET&#39;</span><span class="p">,</span> <span class="s1">&#39;conm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ALPHABET&#39;</span><span class="p">,</span> <span class="s1">&#39;cname&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="mi">18144</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="mi">328795</span><span class="p">,</span> <span class="s1">&#39;gvkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;0011&#39;</span><span class="p">,</span> <span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="s1">&#39;ident&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;aapl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;03783310&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;03783310&#39;</span><span class="p">,</span><span class="s1">&#39;cusip&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;03783310&#39;</span><span class="p">,</span><span class="s1">&#39;cusip&#39;</span><span class="p">,</span><span class="s1">&#39;ident&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;45483&#39;</span><span class="p">,</span> <span class="s1">&#39;permco&#39;</span><span class="p">,</span> <span class="s1">&#39;names&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.IBES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">IBES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IBES'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.IBES" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Structured" title="finds.structured.Structured"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structured</span></code></a></p>
<p>Provide interface to IBES analyst estimates structured datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – Connection to SQL database</p></li>
<li><p><strong>bd</strong> – Custom business day calendar object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.IBES.build_lookup">
<span class="sig-name descname"><span class="pre">build_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sdates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ident'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#finds.structured.IBES.build_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Build lookup function to return target identifier from source</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.IBES.get_linked">
<span class="sig-name descname"><span class="pre">get_linked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'statpers'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sdates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.IBES.get_linked" title="Permalink to this definition"></a></dt>
<dd><p>Query an ibes table, and return with linked crsp permnos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Dataset to query</p></li>
<li><p><strong>fields</strong> – Fields to return</p></li>
<li><p><strong>date_field</strong> – Name of date field in ibes table to query</p></li>
<li><p><strong>link_perm</strong> – Name of permno field in links table</p></li>
<li><p><strong>link_date</strong> – Name of match date in links table</p></li>
<li><p><strong>where</strong> – Sql where clause, as sql string</p></li>
<li><p><strong>limit</strong> – Max number of records to return</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ibes</span><span class="o">.</span><span class="n">get_linked</span><span class="p">(</span><span class="s1">&#39;ident&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cname&#39;</span><span class="p">],</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;statpers&#39;</span><span class="p">):</span>
</pre></div>
</div>
<p>Notes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">where</span> <span class="n">fpi</span><span class="o">=</span><span class="s1">&#39;6&#39;</span>  <span class="o">/*</span> <span class="mi">1</span> <span class="ow">is</span> <span class="k">for</span> <span class="n">annual</span> <span class="n">forecasts</span><span class="p">,</span> <span class="mi">6</span> <span class="ow">is</span> <span class="k">for</span> <span class="n">quarterly</span> <span class="o">*/</span>
<span class="ow">and</span> <span class="n">statpers</span> <span class="o">&lt;</span> <span class="n">ANNDATS_ACT</span> <span class="o">/*</span> <span class="n">forecasts</span> <span class="n">prior</span> <span class="n">to</span> <span class="n">earnings</span> <span class="n">annoucement</span>
<span class="ow">and</span> <span class="n">measure</span><span class="o">=</span><span class="s1">&#39;EPS&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">missing</span><span class="p">(</span><span class="n">medest</span><span class="p">)</span>
<span class="ow">and</span> <span class="ow">not</span> <span class="n">missing</span><span class="p">(</span><span class="n">fpedats</span><span class="p">)</span>  <span class="ow">and</span> <span class="p">(</span><span class="n">fpedats</span><span class="o">-</span><span class="n">statpers</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">(</span><span class="n">fpedats</span><span class="o">-</span><span class="n">statpers</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.IBES.get_permnos">
<span class="sig-name descname"><span class="pre">get_permnos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sdates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.IBES.get_permnos" title="Permalink to this definition"></a></dt>
<dd><p>Return list of permnos mapped to IBES tickers as of a date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – Input list of IBES tickers to lookup</p></li>
<li><p><strong>date</strong> – Prevailing date of link</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.IBES.write_links">
<span class="sig-name descname"><span class="pre">write_links</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.IBES.write_links" title="Permalink to this definition"></a></dt>
<dd><p>Create links table by merging ‘ident’ and CRSP ‘names’ on cusip-8</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.PSTAT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">PSTAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PSTAT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.PSTAT" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Structured" title="finds.structured.Structured"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structured</span></code></a></p>
<p>Provide interface to Compustat structured data sets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – Connection to mysql database</p></li>
<li><p><strong>bd</strong> – Custom business days object</p></li>
</ul>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Screen on INDFMT= ‘INDL’, DATAFMT=’STD’, POPSRC=’D’, and CONSOL=’C’
keeps vast majority of records and uniquely identifies GVKEY, DATADATE.</p></li>
<li><p>_role, _event attributes are Series mapping role and event to description</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.PSTAT.build_lookup">
<span class="sig-name descname"><span class="pre">build_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linkdt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'links'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#finds.structured.PSTAT.build_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Build lookup function to return target identifier from source</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.PSTAT.get_linked">
<span class="sig-name descname"><span class="pre">get_linked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'datadate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lpermno'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linkdt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.PSTAT.get_linked" title="Permalink to this definition"></a></dt>
<dd><p>Query a pstat table, and return with linked crsp permno</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – pstat dataset to query</p></li>
<li><p><strong>fields</strong> – Names of fields to return</p></li>
<li><p><strong>date_field</strong> – Name of date field in pstat table to query</p></li>
<li><p><strong>link_date</strong> – Name of link date field in ‘links’ table</p></li>
<li><p><strong>link_perm</strong> – Name of permno field in ‘links’ table</p></li>
<li><p><strong>where</strong> – Sql where clause, as sql string (optional)</p></li>
<li><p><strong>limit</strong> – Maximum number of records to return (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame containing result of query</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pstat</span><span class="o">.</span><span class="n">get_linked</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;annual&#39;</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;datadate&#39;</span><span class="p">,</span>
<span class="go">           fields=[&#39;ceq&#39;,&#39;pstkrv&#39;,&#39;pstkl&#39;,&#39;pstk&#39;],</span>
<span class="go">           where=&#39;ceq &gt; 0 and datadate&gt;=19930104 and datadate&lt;=20991231&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">keydev</span><span class="o">.</span><span class="n">get_linked</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;keydev&#39;</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;announcedate&#39;</span><span class="p">,</span>
<span class="go">           fields=[&#39;companyname&#39;, &#39;keydeveventtypeid&#39;,</span>
<span class="go">           &#39;keydevtoobjectroletypeid&#39;],</span>
<span class="go">           where=&#39;&#39;, limit=&#39;&#39;):</span>
</pre></div>
</div>
<p>Notes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">keydev</span><span class="o">.</span><span class="n">companyname</span><span class="p">,</span> <span class="n">keydev</span><span class="o">.</span><span class="n">keydeveventtypeid</span><span class="p">,</span>
<span class="n">keydev</span><span class="o">.</span><span class="n">keydevtoobjectroletypeid</span><span class="p">,</span>
<span class="n">keydev</span><span class="o">.</span><span class="n">announcedate</span><span class="p">,</span> <span class="n">keydev</span><span class="o">.</span><span class="n">gvkey</span><span class="p">,</span> <span class="n">lpermno</span> <span class="k">as</span> <span class="n">permno</span>
<span class="kn">from</span> <span class="nn">keydev</span> <span class="n">left</span> <span class="n">join</span> <span class="n">links</span>
<span class="n">on</span> <span class="n">keydev</span><span class="o">.</span><span class="n">gvkey</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">gvkey</span> <span class="ow">and</span> <span class="n">links</span><span class="o">.</span><span class="n">linkdt</span> <span class="o">=</span>
    <span class="p">(</span><span class="n">select</span> <span class="nb">max</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">linkdt</span><span class="p">)</span> <span class="k">as</span> <span class="n">linkdt</span> <span class="kn">from</span> <span class="nn">links</span> <span class="n">c</span>
    <span class="n">where</span> <span class="n">c</span><span class="o">.</span><span class="n">gvkey</span> <span class="o">=</span> <span class="n">keydev</span><span class="o">.</span><span class="n">gvkey</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">linkdt</span> <span class="o">&lt;=</span> <span class="n">keydev</span><span class="o">.</span><span class="n">announcedate</span><span class="p">)</span>
<span class="n">where</span> <span class="n">lpermno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">null</span> <span class="ow">and</span> <span class="n">keydev</span><span class="o">.</span><span class="n">gvkey</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">links</span><span class="o">.</span><span class="n">gvkey</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="ow">and</span> <span class="n">announcedate</span> <span class="o">&gt;=</span> <span class="mi">20180301</span>
<span class="n">limit</span> <span class="mi">100</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.PSTAT.get_permnos">
<span class="sig-name descname"><span class="pre">get_permnos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lpermno'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.PSTAT.get_permnos" title="Permalink to this definition"></a></dt>
<dd><p>Return list of permnos mapped to gvkeys as of a date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – Input list of gvkeys to lookup</p></li>
<li><p><strong>date</strong> – Prevailing date of link</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Signals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">Signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Signals" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stocks</span></code></a></p>
<p>Provide structured stocks data interface to derived signal values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sql</strong> – Connection to SQL database</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebaldate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rebaldate'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Signals.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Return cross-section of signal values available as of a date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – Name of signal to retrieve</p></li>
<li><p><strong>date</strong> – Rebalance date</p></li>
<li><p><strong>start</strong> – Non-inclusive start of date range; -1 means exact date</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="headerlink" href="#finds.structured.Signals.__getitem__" title="Permalink to this definition"></a></dt>
<dd><p>Overrides class method to return Table schema of label</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Signals.read" title="Permalink to this definition"></a></dt>
<dd><p>Read signal values from sql and return as data frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – Name of signal</p></li>
<li><p><strong>where</strong> – Where clause for sql select</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of query with columns = [‘permno’, ‘rebaldate’, label]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Signals.summary" title="Permalink to this definition"></a></dt>
<dd><p>Perform a ‘proc summary’ by rebaldate on a signal’s values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.table_key">
<span class="sig-name descname"><span class="pre">table_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#finds.structured.Signals.table_key" title="Permalink to this definition"></a></dt>
<dd><p>Helper method generates table key name associated with label</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Signals.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebaldate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rebaldate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Signals.write" title="Permalink to this definition"></a></dt>
<dd><p>Saves a new sql table from dataframe of signal values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Signal values, with columns [‘permno’, ‘rebaldate’, label]</p></li>
<li><p><strong>label</strong> – Signal name of column and table (prefixed ‘__’)</p></li>
<li><p><strong>overwrite</strong> – If False, append to table ignoring dups. Else recreate</p></li>
<li><p><strong>rebaldate</strong> – Column name of rebalance dates in input dataframe</p></li>
<li><p><strong>permno</strong> – Column name of permno identifiers in input dataframe</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of rows saved</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>first removes dup keys, and drops null rows before saving to table</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.SignalsFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">SignalsFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.SignalsFrame" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Signals" title="finds.structured.Signals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signals</span></code></a></p>
<p>Cache dataframe of signals values, provide Signals-like interface</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.SignalsFrame.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebaldate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rebaldate'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.SignalsFrame.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Select from rebaldates that fall between start and date, keep latest</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – Name of column to return</p></li>
<li><p><strong>date</strong> – As of this date or possibly earlier</p></li>
<li><p><strong>start</strong> – Non-inclusive start date. Set to 0 for all, -1 for exact</p></li>
<li><p><strong>rebaldate</strong> – Column name containing rebaldate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Stocks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">Stocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Table</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#finds.database.Redis" title="finds.database.Redis"><span class="pre">Redis</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Stocks" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Structured" title="finds.structured.Structured"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structured</span></code></a></p>
<p>Provide interface to structured stock price datasets</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.cache_ret">
<span class="sig-name descname"><span class="pre">cache_ret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ret'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'daily'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Stocks.cache_ret" title="Permalink to this definition"></a></dt>
<dd><p>Pre-generate compounded returns from daily for redis store</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_compounded">
<span class="sig-name descname"><span class="pre">get_compounded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">periods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permnos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_compounded" title="Permalink to this definition"></a></dt>
<dd><p>Compound returns within list of periods, for given permnos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>periods</strong> – Tuples of inclusive begin and end dates of returns period</p></li>
<li><p><strong>permnos</strong> – List of permnos</p></li>
<li><p><strong>use_cache</strong> – If True, then read and write cache; If False, then
write but not read cache.  None to ignore cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of compounded returns in rows, for permnos in cols</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_many">
<span class="sig-name descname"><span class="pre">get_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permnos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_many" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve multiple fields for lists of permnos and dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Name of dataset</p></li>
<li><p><strong>permnos</strong> – List of identifiers to retrieve</p></li>
<li><p><strong>dates</strong> – List of corresponding dates of center of event window</p></li>
<li><p><strong>field</strong> – Names of fields to retrieve</p></li>
<li><p><strong>date_field</strong> – Names of date field in database</p></li>
<li><p><strong>exact</strong> – Whether require exact date match, or allow most recent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame with permno, date, and retrieved fields across columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_range">
<span class="sig-name descname"><span class="pre">get_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_range" title="Permalink to this definition"></a></dt>
<dd><p>Return field values within a date range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Name of dataset to extract from</p></li>
<li><p><strong>fields</strong> – Names of columns to return (and optionally rename as)</p></li>
<li><p><strong>date_field</strong> – Name of date column in the table</p></li>
<li><p><strong>beg</strong> – Inclusive start date in YYYYMMDD format</p></li>
<li><p><strong>end</strong> – Inclusive end date in YYYYMMDD format</p></li>
<li><p><strong>use_cache</strong> – True to read and and write cache;
False to write but not read cache; None to ignore cache</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame multi-indexed by permno, date</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_ret">
<span class="sig-name descname"><span class="pre">get_ret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'daily'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ret'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_ret" title="Permalink to this definition"></a></dt>
<dd><p>Compounded returns between start and end dates of all stocks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – Inclusive start date (YYYYMMDD)</p></li>
<li><p><strong>end</strong> – Inclusive end date (YYYYMMDD)</p></li>
<li><p><strong>dataset</strong> – Name of dataset to retrieve (default is <cite>daily</cite>)</p></li>
<li><p><strong>field</strong> – Name of returns field</p></li>
<li><p><strong>date_field</strong> – Name of date field</p></li>
<li><p><strong>use_cache</strong> – True to read and and write cache;
False to write but not read cache; None to ignore cache</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Series:</dt><dd><p>DataFrame with prod(min_count=1) of returns in column <cite>ret</cite>,
with rows indexed by permno</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>If start and end are first and last business dates of a month, then
search range is expanded to include first and last calendar dates
of respective months, and <cite>monthly</cite> table is queried</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_section">
<span class="sig-name descname"><span class="pre">get_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_section" title="Permalink to this definition"></a></dt>
<dd><p>Return a cross-section of values of fields as of a single date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Dataset to extract from</p></li>
<li><p><strong>fields</strong> – list of columns to return</p></li>
<li><p><strong>date_field</strong> – Name of date column in the table</p></li>
<li><p><strong>date</strong> – Desired date in YYYYMMDD format</p></li>
<li><p><strong>start</strong> – Non-inclusive date of starting range; if -1 then exact date</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series (if fields is str) or DataFrame (if fields is list-like)
indexed by permno</p>
</dd>
</dl>
<p>Note:</p>
<ul class="simple">
<li><p>If start is not -1, then the latest prevailing record for each
between (non-inclusive) start and (inclusive) date is returned</p></li>
</ul>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s1">&#39;shares&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;shrenddt&#39;</span><span class="p">,</span><span class="s1">&#39;shrout&#39;</span><span class="p">],</span> <span class="s1">&#39;shrsdt&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;comnam&#39;</span><span class="p">],</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">-</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_series">
<span class="sig-name descname"><span class="pre">get_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">permnos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ret'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'daily'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">19000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">29001231</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_series" title="Permalink to this definition"></a></dt>
<dd><p>Return time series of a field for multiple permnos as DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>permnos</strong> – Identifiers to filter</p></li>
<li><p><strong>field</strong> – Name of column to extract</p></li>
<li><p><strong>start</strong> – Inclusive start date (YYYYMMDD)</p></li>
<li><p><strong>end</strong> – Inclusive end date (YYYYMMDD)</p></li>
<li><p><strong>dataset</strong> – Name of dataset to retrieve <cite>ret</cite> (default is <cite>daily</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame indexed by date with permnos in columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Stocks.get_window">
<span class="sig-name descname"><span class="pre">get_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permnos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Stocks.get_window" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve field values for permnos in window centered around dates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Name of dataset</p></li>
<li><p><strong>field</strong> – Name of field to retrieve</p></li>
<li><p><strong>permnos</strong> – List of identifiers to retrieve</p></li>
<li><p><strong>date_field</strong> – Name of date field in database</p></li>
<li><p><strong>dates</strong> – List of corresponding dates of center of event window</p></li>
<li><p><strong>left</strong> – Relative (inclusive) offset of start of event window</p></li>
<li><p><strong>right</strong> – Relative (inclusive) offset of end of event window</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(right-left)] of field values in event window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame columns [0</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.StocksBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">StocksBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><span class="pre">Stocks</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['ret',</span> <span class="pre">'retx']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.StocksBuffer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stocks</span></code></a></p>
<p>Cache daily returns into memory, and provide Stocks-like interface</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksBuffer.get_ret">
<span class="sig-name descname"><span class="pre">get_ret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ret'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.StocksBuffer.get_ret" title="Permalink to this definition"></a></dt>
<dd><p>Return compounded stock returns between beg and end dates</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.StocksFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">StocksFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsuffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'permno'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.StocksFrame" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stocks</span></code></a></p>
<p>Mimic Stocks object given an input DataFrame of returns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame of returns with date in index and permno in columns</p></li>
<li><p><strong>rsuffix</strong> – replicate output columns and append rsuffix to column name</p></li>
<li><p><strong>identifier</strong> – name of identifier column</p></li>
</ul>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>kludge to manipulate ad-hoc DataFrame of  asset returns as Stocks-like</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.bd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bd</span></span><a class="headerlink" href="#finds.structured.StocksFrame.bd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>class to mimic behavior of BusDay object</p>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.bd.begmo">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">begmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.StocksFrame.bd.begmo" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.bd.endmo">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">endmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.StocksFrame.bd.endmo" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.bd.holding_periods">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">holding_periods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pordates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.StocksFrame.bd.holding_periods" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.get_ret">
<span class="sig-name descname"><span class="pre">get_ret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.StocksFrame.get_ret" title="Permalink to this definition"></a></dt>
<dd><p>Return data as ‘ret’ series between start and end dates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.StocksFrame.get_series">
<span class="sig-name descname"><span class="pre">get_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">permnos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#finds.structured.StocksFrame.get_series" title="Permalink to this definition"></a></dt>
<dd><p>Return the series for target permnos</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Structured">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">Structured</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.busday.BusDay" title="finds.busday.BusDay"><span class="pre">BusDay</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Table</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#finds.database.Redis" title="finds.database.Redis"><span class="pre">Redis</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Structured" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for interface to structured datasets, stored in SQL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – Connection instance to mysql database</p></li>
<li><p><strong>bd</strong> – Custom business calendar instance</p></li>
<li><p><strong>tables</strong> – Sqlalchemy Tables and names defined for this datasets group</p></li>
<li><p><strong>identifier</strong> – Name of field of unique identifier key</p></li>
<li><p><strong>name</strong> – Display name for this datasets group</p></li>
<li><p><strong>rdb</strong> – Connector to Redis cache store, if desired</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="finds.structured.Structured.identifier">
<span class="sig-name descname"><span class="pre">identifier</span></span><a class="headerlink" href="#finds.structured.Structured.identifier" title="Permalink to this definition"></a></dt>
<dd><p>Field name of identifier key by this datasets group</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="finds.structured.Structured.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#finds.structured.Structured.name" title="Permalink to this definition"></a></dt>
<dd><p>Display name for this datasets group</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="finds.structured.Structured.Lookup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.database.SQL" title="finds.database.SQL"><span class="pre">SQL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Structured.Lookup" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Loads dated identifier mappings to memory, to lookup by date</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql</strong> – SQL connection instance</p></li>
<li><p><strong>source</strong> – Name of source identifier key</p></li>
<li><p><strong>target</strong> – Name of target identifier key to return</p></li>
<li><p><strong>date_field</strong> – Name of date field in database table</p></li>
<li><p><strong>table</strong> – Physical SQL table name containing identifier mappings</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.Lookup.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">99999999</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#finds.structured.Structured.Lookup.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Return target identifiers matched to source as of date</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.Lookup.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Structured.Lookup.__getitem__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="headerlink" href="#finds.structured.Structured.__getitem__" title="Permalink to this definition"></a></dt>
<dd><p>Return the table object corresponding to a dataset label</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.build_lookup">
<span class="sig-name descname"><span class="pre">build_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#finds.structured.Structured.build_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Helper to build lookup of target from source identifiers</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.create_all">
<span class="sig-name descname"><span class="pre">create_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Structured.create_all" title="Permalink to this definition"></a></dt>
<dd><p>Create all tables and indexes in SQL using associated schemas</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.drop_all">
<span class="sig-name descname"><span class="pre">drop_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#finds.structured.Structured.drop_all" title="Permalink to this definition"></a></dt>
<dd><p>Drop all associated tables from SQL database</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.get_linked">
<span class="sig-name descname"><span class="pre">get_linked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Structured.get_linked" title="Permalink to this definition"></a></dt>
<dd><p>Query a dataset, and join ‘links’ table to return data with permno</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Name internal Table to query data from</p></li>
<li><p><strong>fields</strong> – Data fields to retrieve</p></li>
<li><p><strong>date_field</strong> – Name of date field in data table</p></li>
<li><p><strong>link_date</strong> – Name of link date field in ‘links’ table</p></li>
<li><p><strong>link_perm</strong> – Name of permno field in ‘links’ table</p></li>
<li><p><strong>where</strong> – Where clause (optional)</p></li>
<li><p><strong>limit</strong> – Maximum rows to return (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame containing result of query</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.get_permnos">
<span class="sig-name descname"><span class="pre">get_permnos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Structured.get_permnos" title="Permalink to this definition"></a></dt>
<dd><p>Returns matching permnos as of a prevailing date from ‘links’ table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – Input list of identifiers to lookup</p></li>
<li><p><strong>date</strong> – Prevailing date of link</p></li>
<li><p><strong>link_perm</strong> – Name of permno field in ‘links’ table</p></li>
<li><p><strong>link_date</strong> – Name of link date field in ‘links’ table</p></li>
<li><p><strong>permno</strong> – Name of field to output permnos to</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of Linked permnos, as of prevailing date; missing set to 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="finds.structured.Structured.load_csv">
<span class="sig-name descname"><span class="pre">load_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csvfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'latin-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">na_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.Structured.load_csv" title="Permalink to this definition"></a></dt>
<dd><p>Insert ignore into SQL table from csvfile, and return as DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – dataset name</p></li>
<li><p><strong>csvfile</strong> – csv file name</p></li>
<li><p><strong>drop</strong> – {column: value} specifies rows with value in column</p></li>
<li><p><strong>replace</strong> – {column: [old,new]} specifies values to replace in column</p></li>
<li><p><strong>sep</strong> – args for pd.read_csv</p></li>
<li><p><strong>encoding</strong> – args for pd.read_csv</p></li>
<li><p><strong>header</strong> – args for pd.read_csv</p></li>
<li><p><strong>low_memory</strong> – args for pd.read_csv</p></li>
<li><p><strong>na_filter</strong> – args for pd.read_csv</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame containing loaded data</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Create new table, if not exists, using associated schema</p></li>
<li><p>New records with duplicate key are dropped (insert ignore used)</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.structured.as_dtypes">
<span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">as_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_duplicates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'first'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#finds.structured.as_dtypes" title="Permalink to this definition"></a></dt>
<dd><p>Convert DataFrame dtypes to the given sqlalchemy Column types</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – Input DataFrame to apply new data types from target columns</p></li>
<li><p><strong>columns</strong> – Target sqlalchemy column types as dict of {label: type}</p></li>
<li><p><strong>sort_values</strong> – List of column names to sort by</p></li>
<li><p><strong>drop_duplicates</strong> – list of fields if all duplicated to drop rows</p></li>
<li><p><strong>keep</strong> – ‘first’ or ‘last’ row to keep if drop duplicates</p></li>
<li><p><strong>replace</strong> – dict of {column label: tuple(old,replacement) values}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame with columns and rows transformed</p>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Columns of DataFrame are dropped if not specified in columns input</p></li>
<li><p>If input is None, then return empty DataFrame with given column types</p></li>
<li><p>Blank values in boolean and int fields are set to False/0.</p></li>
<li><p>Invalid/blank values in double field are coerced to NaN.</p></li>
<li><p>Invalid values in int field are coerced to 0</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="finds.structured.famafrench_sorts">
<span class="sig-prename descclassname"><span class="pre">finds.structured.</span></span><span class="sig-name descname"><span class="pre">famafrench_sorts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.structured.Stocks" title="finds.structured.Stocks"><span class="pre">Stocks</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#finds.structured.Signals" title="finds.structured.Signals"><span class="pre">Signals</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalbeg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(30,</span> <span class="pre">70)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leverage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minprc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mincap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdecile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#finds.structured.famafrench_sorts" title="Permalink to this definition"></a></dt>
<dd><p>Generate monthly time series of holdings by two-way sort procedure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stocks</strong> – Stocks object for accessing stock returns and price data</p></li>
<li><p><strong>label</strong> – Name of signal to retrieve</p></li>
<li><p><strong>signals</strong> – Call to extract cross section of values for the signal</p></li>
<li><p><strong>rebalbeg</strong> – First rebalance date (YYYYMMDD)</p></li>
<li><p><strong>rebalend</strong> – Last holding date (YYYYMMDD)</p></li>
<li><p><strong>pct</strong> – Percentile breakpoints to sort high, medium and low buckets</p></li>
<li><p><strong>window</strong> – No. of months to look back for signal values; 0 is exact month</p></li>
<li><p><strong>months</strong> – List of months (e.g. 6=June) to retrieve univ and market cap</p></li>
<li><p><strong>maxdecile</strong> – Include largest stocks decile from 1 through maxdecile</p></li>
<li><p><strong>mincap</strong> – Minimum market cap</p></li>
<li><p><strong>minobs</strong> – Minimum required sample size with non-missing signal values</p></li>
<li><p><strong>leverage</strong> – Multiplier for leverage or shorting</p></li>
</ul>
</dd>
</dl>
<p>Notes:</p>
<ul class="simple">
<li><p>Independent sort by median (NYSE) mkt cap and 30/70 (NYSE) HML percentiles</p></li>
<li><p>Subportfolios of the intersections are value-weighted;</p></li>
<li><p>Spread portfolios are equal-weighted of subportfolios</p></li>
<li><p>Portfolio are resorted every June; and other months’ holdings are
adjusted by monthly realized retx (i.e. dividends not reinvested)</p></li>
</ul>
</dd></dl>

</section>
<section id="module-finds">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-finds" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="finds" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Terence Lim.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>