

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Time Series Analysis &#8212; Financial Data Science Python Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2.3_time_series';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Approximate Factor Models" href="2.4_approximate_factors.html" />
    <link rel="prev" title="Linear Regression Diagonostics" href="2.2_regression_diagnostics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
  
    <p class="title logo__title">Financial Data Science Python Notebooks</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    FINANCIAL DATA SCIENCE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.1_stock_prices.html">Stock Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.2_jegadeesh_titman.html">Jegadeesh-Titman Rolling Portfolios</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.3_fama_french.html">Fama-French Portfolio Sorts</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.4_fama_macbeth.html">Fama-Macbeth Cross-sectional Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.5_contrarian_trading.html">Contrarian Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.6_quant_factors.html">Quant Factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.7_event_study.html">Event Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.1_economic_indicators.html">Economic Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.2_regression_diagnostics.html">Linear Regression Diagonostics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Time Series Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.4_approximate_factors.html">Approximate Factor Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.5_economic_states.html">State Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.1_term_structure.html">Term Structure of Interest Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.2_bond_returns.html">Interest Rate Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.3_options_pricing.html">Options Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.4_value_at_risk.html">Value at Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.6_market_microstructure.html">Market Microstructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.7_event_risk.html">Event Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.1_network_graphs.html">Supply Chain Network Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.2_community_detection.html">Industry Community Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.3_graph_centrality.html">Input-Output Graph Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.4_link_prediction.html">Product Market Link Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.5_spatial_regression.html">Earnings Spatial Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.1_fomc_topics.html">FOMC Topic Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.2_management_sentiment.html">Management Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.1_classification_models.html">Machine Learning: Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.2_regression_models.html">Machine Learning: Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.3_deep_learning.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.4_convolutional_net.html">Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.5_recurrent_net.html">Recurrent Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.6_reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.7_language_modeling.html">Language Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.1_large_language_models.html">Large Language Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.2_llm_finetuning.html">Fine-tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.3_llm_prompting.html">Prompting</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.4_llm_agents.html">Agents</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/terence-lim/financial-data-science-notebooks.git" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/terence-lim/financial-data-science-notebooks.git/issues/new?title=Issue%20on%20page%20%2F2.3_time_series.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/2.3_time_series.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Time Series Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonality">Seasonality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stationarity">Stationarity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation">Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-models">Time Series Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autoregressive-ar-models">Autoregressive (AR) models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-average-ma-models">Moving average (MA) models**</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arma-models">ARMA models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-lengths">Lag lengths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-component">Seasonal component</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-roots">Unit Roots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sarimax-model">SARIMAX model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting">Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ar-lag-order-selection">AR lag order selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-step-forecast">One-step forecast</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-step-forecast">Multi-step forecast</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#granger-causality">Granger causality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-response-function">Impulse response function</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="time-series-analysis">
<h1>Time Series Analysis<a class="headerlink" href="#time-series-analysis" title="Permalink to this heading">#</a></h1>
<p><em>The only thing we know about the future is that it will be different</em> - Peter Drucker</p>
<p>Time series analysis is a fundamental statistical technique used to analyze data points collected over time. A time series can exhibit multiple components, such as long-term trends, cyclical fluctuations, seasonal variations, and irregular random movements. Understanding these components enables analysts to build accurate predictive models. We explore key concepts in time series analysis, including trend patterns, seasonality, stationarity, autocorrelation, and various statistical models such as autoregressive (AR), moving average (MA), and autoregressive moving average (ARMA) models. We also examine forecasting methods and statistical tests used to assess time series properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By: Terence Lim, 2020-2025 (terence-lim.github.io)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="kn">from</span> <span class="nn">statsmodels.tsa.ar_model</span> <span class="kn">import</span> <span class="n">AutoReg</span><span class="p">,</span> <span class="n">ar_select_order</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span><span class="p">,</span> <span class="n">acf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="n">SARIMAX</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">grangercausalitytests</span><span class="p">,</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">VAR</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>        
<span class="kn">from</span> <span class="nn">finds.readers</span> <span class="kn">import</span> <span class="n">Alfred</span>
<span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="n">VERBOSE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># %matplotlib qt</span>
</pre></div>
</div>
</div>
</div>
<p>We retrieve the Industrial Production (IP) total index monthly time series from FRED.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">series_id</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;IPB50001N&#39;</span><span class="p">,</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># not seasonally adjusted</span>
<span class="n">alf</span> <span class="o">=</span> <span class="n">Alfred</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;fred&#39;</span><span class="p">][</span><span class="s1">&#39;api_key&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">alf</span><span class="p">(</span><span class="n">series_id</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">date_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">100</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">100</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>               <span class="c1"># set index to datetime type with &#39;M frequency</span>
<span class="n">alf</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="n">series_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Industrial Production: Total Index&#39;
</pre></div>
</div>
</div>
</div>
<section id="seasonality">
<h2>Seasonality<a class="headerlink" href="#seasonality" title="Permalink to this heading">#</a></h2>
<p>A time series can be broken down into three key components:</p>
<ul class="simple">
<li><p><strong>Trend</strong> – Represents long-term movements in the data.</p></li>
<li><p><strong>Seasonality</strong> – Captures predictable and recurring changes within a specific time frame.</p></li>
<li><p><strong>Cyclical</strong> – Encompasses longer-term cycles that are influenced by broader economic or structural factors.</p></li>
</ul>
<p>If a time series <span class="math notranslate nohighlight">\(Y_t\)</span>​ exhibits seasonality, its mean can differ across periods, repeating every <span class="math notranslate nohighlight">\(s\)</span> periods (e.g., quarterly with <span class="math notranslate nohighlight">\(s=4\)</span> or monthly with <span class="math notranslate nohighlight">\(s=12\)</span>). Deterministic seasonal effects can be effectively modeled using dummy variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Seasonality Decomposition Plot</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">result</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">alf</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">date_title</span><span class="p">,</span>
                     <span class="n">ylabel</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span>
                  <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Residual&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a9feca6c8c3d568aec5e4a5564b324baadd692029e23531d9a3b591c74b124cf.png" src="_images/a9feca6c8c3d568aec5e4a5564b324baadd692029e23531d9a3b591c74b124cf.png" />
</div>
</div>
</section>
<section id="stationarity">
<h2>Stationarity<a class="headerlink" href="#stationarity" title="Permalink to this heading">#</a></h2>
<p>A time series is considered <strong>covariance-stationary</strong> if it meets three key conditions:</p>
<ol class="arabic simple">
<li><p>The mean remains constant over time, i.e., <span class="math notranslate nohighlight">\( E[Y_t] = m \)</span> for all <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
<li><p>The variance is finite and does not change over time, i.e., <span class="math notranslate nohighlight">\( V[Y_t] = \gamma_0 &lt; \infty \)</span>.</p></li>
<li><p>The autocovariance depends only on the time lag <span class="math notranslate nohighlight">\( h \)</span> and not on <span class="math notranslate nohighlight">\( t \)</span>, i.e., <span class="math notranslate nohighlight">\( Cov[Y_t, Y_{t-h}] = \gamma_h \)</span>.</p></li>
</ol>
<p>Covariance stationarity depends on the first two moments of a time series. Stationarity is crucial for modeling and forecasting because stationary series exhibit stable statistical properties. The <strong>Augmented Dickey-Fuller (ADF) test</strong> helps determine whether a time series has a unit root, with the null hypothesis stating that a unit root is present. If the p-value is below a critical threshold, the null hypothesis can be rejected, indicating stationarity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">adf</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;I(1)&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">adf</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">adf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())},</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;Test Statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Lags Used&#39;</span><span class="p">,</span> <span class="s1">&#39;Obs Used&#39;</span><span class="p">]</span> <span class="o">+</span>
                             <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;critical(</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">adf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Test Statistic</th>
      <th>p-value</th>
      <th>Lags Used</th>
      <th>Obs Used</th>
      <th>critical(1%)</th>
      <th>critical(5%)</th>
      <th>critical(10%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>I(1)</th>
      <td>-7.266</td>
      <td>0.0</td>
      <td>23</td>
      <td>1248</td>
      <td>-3.436</td>
      <td>-2.864</td>
      <td>-2.568</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histogram Plot and Kernel Density Estimate</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density Plot of log(</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;diff log </span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
             <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#line_kws={&quot;color&quot;: &quot;r&quot;}</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density Plot of diff log(</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6f20889bc773fc531ddb40df4313a71c7c30f4f95d851030a1565abbae1c2031.png" src="_images/6f20889bc773fc531ddb40df4313a71c7c30f4f95d851030a1565abbae1c2031.png" />
</div>
</div>
</section>
<section id="autocorrelation">
<h2>Autocorrelation<a class="headerlink" href="#autocorrelation" title="Permalink to this heading">#</a></h2>
<p>Autocorrelation measures the relationship between time series observations at different points in time. The autocorrelation function (ACF) at lag <span class="math notranslate nohighlight">\( h \)</span> is given by:<br />
$<span class="math notranslate nohighlight">\(
\rho_h = \frac{\gamma_h}{\gamma_0}
\)</span><span class="math notranslate nohighlight">\(  
where \)</span> \gamma_h <span class="math notranslate nohighlight">\( is the autocovariance at lag \)</span> h <span class="math notranslate nohighlight">\(, and \)</span> \gamma_0 $ is the variance.</p>
<p>The <strong>partial autocorrelation function (PACF)</strong> isolates the direct relationship between observations separated by lag <span class="math notranslate nohighlight">\( h \)</span>, removing the influence of intermediate lags (i.e., <span class="math notranslate nohighlight">\(Y_{t-1}, Y_{t-2}, ..., Y_{t-h+1}\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ywm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">alf</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">observed</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">date_title</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ffde99b6ae6f859d34c91f6a53d1fca143fc497edab455d96d5805ab62825079.png" src="_images/ffde99b6ae6f859d34c91f6a53d1fca143fc497edab455d96d5805ab62825079.png" />
</div>
</div>
</section>
<section id="time-series-models">
<h2>Time Series Models<a class="headerlink" href="#time-series-models" title="Permalink to this heading">#</a></h2>
<section id="autoregressive-ar-models">
<h3>Autoregressive (AR) models<a class="headerlink" href="#autoregressive-ar-models" title="Permalink to this heading">#</a></h3>
<p>Autoregressive (AR) models describe a time series in terms of its past values. An AR(1) process follows:<br />
$<span class="math notranslate nohighlight">\(
Y_t = \delta + \phi Y_{t-1} + \epsilon_t
\)</span><span class="math notranslate nohighlight">\(  
where \)</span> \delta <span class="math notranslate nohighlight">\( is the intercept, \)</span> \phi <span class="math notranslate nohighlight">\( is the autoregressive coefficient, and \)</span> \epsilon_t $ is white noise.</p>
<p>For a higher-order AR(p) model:<br />
$<span class="math notranslate nohighlight">\(
Y_t = \mu + \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + ... + \phi_p Y_{t-p} + \epsilon_t
\)</span>$</p>
<p>The PACF for an AR process is nonzero only for the first <span class="math notranslate nohighlight">\( p \)</span> lags, while the ACF gradually decays (<span class="math notranslate nohighlight">\(\rho(h) = \phi^{|h|}\)</span>)</p>
</section>
<section id="moving-average-ma-models">
<h3>Moving average (MA) models**<a class="headerlink" href="#moving-average-ma-models" title="Permalink to this heading">#</a></h3>
<p>A moving average model expresses <span class="math notranslate nohighlight">\( Y_t \)</span> as a function of past shocks:<br />
$<span class="math notranslate nohighlight">\(
Y_t = \mu + \theta_1 \epsilon_{t-1} + \epsilon_t
\)</span><span class="math notranslate nohighlight">\(  
An MA(q) model extends this to include \)</span> q <span class="math notranslate nohighlight">\( lags of \)</span> \epsilon <span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(Y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + ... + \theta_q \epsilon_{t-q}\)</span>$</p>
<p>The ACF of an MA process is zero for lags greater than <span class="math notranslate nohighlight">\( q \)</span>, while the PACF has a more complex structure.</p>
</section>
<section id="arma-models">
<h3>ARMA models<a class="headerlink" href="#arma-models" title="Permalink to this heading">#</a></h3>
<p>An <strong>ARMA(p, q)</strong> model combines AR and MA components. For example, a simple ARMA(1,1) evolves according to:
$<span class="math notranslate nohighlight">\(
Y_t = \mu + \phi Y_{t-1} + \theta \epsilon_{t-1} + \epsilon_t
\)</span>$</p>
<ul class="simple">
<li><p>The mean of this process is <span class="math notranslate nohighlight">\(\mu = \delta / (1 - \phi)\)</span></p></li>
<li><p>The variance is <span class="math notranslate nohighlight">\(\gamma_0 = \sigma^2(1 + 2\phi \theta + \theta^2)/(1 - \phi^2)\)</span></p></li>
</ul>
<p>An ARMA(1,1) process is covariance-stationary if <span class="math notranslate nohighlight">\(|\phi| &lt;&gt; 1\)</span>. The MA coefficient plays no role in determining whether the process is covariance-stationary, because any MA is covariance-stationary as the MA component only affects a single lag of the shock. The AR component, however, affects all lagged shocks and so if <span class="math notranslate nohighlight">\(\phi_1\)</span> is too large, then the time series is not covariance-stationary.</p>
</section>
<section id="lag-lengths">
<h3>Lag lengths<a class="headerlink" href="#lag-lengths" title="Permalink to this heading">#</a></h3>
<p>Determining the appropriate lag lengths for the AR and MA components (i.e., p and q, respectively) is a key challenge when building an ARMA model. The first step in model building is to inspect the sample autocorrelation and sample PACFs.</p>
<p>The <strong>Box-Pierce</strong> test statistic is the sum of the squared autocorrelations scaled by the sample size T:
$<span class="math notranslate nohighlight">\(Q_{BP} = T\sum_{i=1}^h (\dfrac{T+1}{T-1}) \hat{\rho}_i^2\)</span>$</p>
<p>When the null is true, <span class="math notranslate nohighlight">\(Q_{BP}\)</span> is asymptotically distributed as a <span class="math notranslate nohighlight">\(\chi_h^2\)</span> variable.</p>
<p>The <strong>Ljung-Box</strong> statistic is a modified version of the Box-Pierce statistic that works better in smaller samples, and is defined as:
$<span class="math notranslate nohighlight">\(Q_{LB} = T\sum_{i=1}^h (\dfrac{T+2}{T-i}) \hat{\rho}_i^2\)</span>$</p>
</section>
<section id="seasonal-component">
<h3>Seasonal component<a class="headerlink" href="#seasonal-component" title="Permalink to this heading">#</a></h3>
<p>Seasonal components can be added to the short-term components of an ARMA(p,q) model, by using lags only at the seasonal frequency.  A seasonal ARMA combines
these two components into a single specification:</p>
<div class="math notranslate nohighlight">
\[ARMA (p, q) \times (p_s, q_s)_f\]</div>
<p>where p and q are the orders of the short-run lag polynomials, <span class="math notranslate nohighlight">\(p_s\)</span> and <span class="math notranslate nohighlight">\(q_s\)</span> represent seasonal lag orders, and <span class="math notranslate nohighlight">\(f\)</span> denotes the seasonal horizon (e.g., every 3 or 12 months with monthly observations).</p>
</section>
<section id="unit-roots">
<h3>Unit Roots<a class="headerlink" href="#unit-roots" title="Permalink to this heading">#</a></h3>
<p>Random walks are most important source of <strong>non-stationarity</strong> in economic time series. A simple random walk process evolves according to:</p>
<div class="math notranslate nohighlight">
\[Y_t = Y_{t-1} + \epsilon_t\]</div>
<p>Unit roots generalize random walks by adding short-run stationary dynamics to the long-run random walk.</p>
<p>Spurious relationships can occur when non-stationary series are regressed against each other; this produces produces a coefficient estimate that is large and seemingly statistically different from zero when using conventional statistical distributions to obtain the critical values.</p>
<p>Differencing removes unit roots and prevents such misleading results. If <span class="math notranslate nohighlight">\(Y_t\)</span> has a unit root (i.e. has <strong>integration order</strong> equal to 1), then the difference: <span class="math notranslate nohighlight">\(\Delta Y_t = Y_t - Y_{t-1}\)</span> does not.</p>
</section>
<section id="sarimax-model">
<h3>SARIMAX model<a class="headerlink" href="#sarimax-model" title="Permalink to this heading">#</a></h3>
<p>The <strong>Seasonal AutoRegressive Integrated Moving Average with eXogenous Regressors (SARIMAX)</strong> model is denoted:<br />
$<span class="math notranslate nohighlight">\(
(p, d, q) \times (P, D, Q)_s
\)</span>$<br />
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( (p, d, q) \)</span> are the orders of AR, differencing, and MA components.</p></li>
<li><p><span class="math notranslate nohighlight">\( (P, D, Q, s) \)</span> are the seasonal counterparts and periodicity.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split_date</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">]</span>   <span class="c1"># train/test split date</span>
<span class="c1"># df_train = df.loc[:split_date].dropna()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit a SARIMA(1,1,3) with seasonal order (0, 0, 0, 12)</span>
<span class="n">pdq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1">#(12, 1, 0)</span>
<span class="n">seasonal_pdqs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">arima</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">pdq</span><span class="p">,</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="n">seasonal_pdqs</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">arima</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">arima</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            4     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f= -2.09476D+00    |proj g|=  3.46166D-01

At iterate    5    f= -2.09484D+00    |proj g|=  2.67321D-02

At iterate   10    f= -2.09486D+00    |proj g|=  1.29274D-01

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    4     14     18      1     0     0   8.413D-04  -2.095D+00
  F =  -2.0948681083990448     

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH             
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> This problem is unconstrained.
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>IPB50001N</td>    <th>  No. Observations:  </th>   <td>1273</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 1, 1)</td> <th>  Log Likelihood     </th> <td>2666.767</td> 
</tr>
<tr>
  <th>Date:</th>            <td>Mon, 03 Mar 2025</td> <th>  AIC                </th> <td>-5325.534</td>
</tr>
<tr>
  <th>Time:</th>                <td>10:54:09</td>     <th>  BIC                </th> <td>-5304.941</td>
</tr>
<tr>
  <th>Sample:</th>             <td>01-31-1919</td>    <th>  HQIC               </th> <td>-5317.799</td>
</tr>
<tr>
  <th></th>                   <td>- 01-31-2025</td>   <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    0.0027</td> <td>    0.001</td> <td>    2.396</td> <td> 0.017</td> <td>    0.000</td> <td>    0.005</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>   -0.1167</td> <td>    0.223</td> <td>   -0.524</td> <td> 0.600</td> <td>   -0.553</td> <td>    0.320</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>    0.2195</td> <td>    0.222</td> <td>    0.987</td> <td> 0.323</td> <td>   -0.216</td> <td>    0.655</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0009</td> <td> 2.21e-05</td> <td>   39.946</td> <td> 0.000</td> <td>    0.001</td> <td>    0.001</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.02</td> <th>  Jarque-Bera (JB):  </th> <td>563.24</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.87</td> <th>  Prob(JB):          </th>  <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.31</td> <th>  Skew:              </th>  <td>-0.20</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.00</td> <th>  Kurtosis:          </th>  <td>6.23</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="_images/16f175e4c120a1f562e5cc84ceb6692b5b626ef379eb0b139d149b326f71343c.png" src="_images/16f175e4c120a1f562e5cc84ceb6692b5b626ef379eb0b139d149b326f71343c.png" />
</div>
</div>
</section>
</section>
<section id="forecasting">
<h2>Forecasting<a class="headerlink" href="#forecasting" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">series_id</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;INDPRO&#39;</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">alf</span><span class="p">(</span><span class="n">series_id</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df_all</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df_all</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">split_date</span><span class="p">]</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">split_date</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="ar-lag-order-selection">
<h3>AR lag order selection<a class="headerlink" href="#ar-lag-order-selection" title="Permalink to this heading">#</a></h3>
<p>The most natural measure of fit is the sample variance of the estimated residuals, also known as the Mean Squared Error (MSE) of the model. Unfortunately, choosing a model to minimize MSE also selects a specification that is far too large. The solution to this overfitting problem is to add a penalty to the MSE that increases each time a new parameter is added, employing criteria like <strong>Akaike Information Criterion (AIC)</strong> and <strong>Bayesian Information Criterion (BIC)</strong>.</p>
<ul class="simple">
<li><p>AIC is calculated by <span class="math notranslate nohighlight">\(T \ln \hat{\sigma}^2 + 2 k\)</span>, where T is the sample size and k is the number of parameters.</p></li>
<li><p>BIC alters the penalty and is computed by <span class="math notranslate nohighlight">\(T \ln \hat{\sigma}^2 2 + k \ln T\)</span></p></li>
</ul>
<p>Unlike the AIC, the BIC has a cost per parameter that slowly increases with T. Hence BIC always selects a model that is no larger than the model selected by the AIC (assuming <span class="math notranslate nohighlight">\(\ln T &gt; 2\)</span>), and is a consistent model selection criterion (i.e., the true model is selected as <span class="math notranslate nohighlight">\(T \rightarrow \infty\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="n">ar_select_order</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">ic</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">,</span> <span class="n">old_names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">ar_lags</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(BIC) lags= &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lags</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(BIC) lags=  1 : [1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train final model on train split</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">old_names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            AutoReg Model Results                             
==============================================================================
Dep. Variable:                 INDPRO   No. Observations:                 1261
Model:                     AutoReg(1)   Log Likelihood                3366.312
Method:               Conditional MLE   S.D. of innovations              0.017
Date:                Mon, 03 Mar 2025   AIC                          -6726.625
Time:                        10:54:10   BIC                          -6711.208
Sample:                    03-31-1919   HQIC                         -6720.831
                         - 02-29-2024                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.0013      0.000      2.705      0.007       0.000       0.002
INDPRO.L1      0.4859      0.025     19.794      0.000       0.438       0.534
                                    Roots                                    
=============================================================================
                  Real          Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            2.0581           +0.0000j            2.0581            0.0000
-----------------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="one-step-forecast">
<h3>One-step forecast<a class="headerlink" href="#one-step-forecast" title="Permalink to this heading">#</a></h3>
<p><strong>One-step forecast</strong> predicts <span class="math notranslate nohighlight">\( Y_{T+1} \)</span> using all available data up to time <span class="math notranslate nohighlight">\( T \)</span>, including the entire prior history of Y (<span class="math notranslate nohighlight">\(Y_T, Y_{T-1}, ... \)</span>), as well as all values of any other variables that occurred at time T or earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Observations to predict are from the oos test split</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">df_all</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">old_names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use model params from train split, start predictions from last train row    </span>
<span class="n">df_pred</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_pred</span><span class="p">)</span>
<span class="c1">#var = np.mean(np.square(df_test - df_train.mean()))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ST Forecast(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">): rmse=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ST Forecast(11): rmse=0.006247508053669628
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">df_pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">series_id</span> <span class="o">+</span> <span class="s2">&quot; (one-step forecasts)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/462460299151713d76264012a81f188be063dd06fa8c6d5adbc4641aa37fbbbd.png" src="_images/462460299151713d76264012a81f188be063dd06fa8c6d5adbc4641aa37fbbbd.png" />
</div>
</div>
</section>
<section id="multi-step-forecast">
<h3>Multi-step forecast<a class="headerlink" href="#multi-step-forecast" title="Permalink to this heading">#</a></h3>
<p><strong>Multi-step forecasts</strong> recursively predict values at future horizons, starting with <span class="math notranslate nohighlight">\(E_T[Y_{T+ 1}]. The forecast at horizon h depends on forecasts from earlier steps (\)</span>E_T[Y_{T+ 1}], …, E_T [Y_{T+ h - 1}]). When these quantities appear in the forecast for period <span class="math notranslate nohighlight">\(T + h\)</span>, they are replaced by the forecasts computed for horizons <span class="math notranslate nohighlight">\(1, 2, ... , h - 1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set dynamic=True for multi-step ahead predictions</span>
<span class="n">df_pred</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">start</span><span class="o">=</span><span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_pred</span><span class="p">)</span>
<span class="c1">#var = np.mean(np.square(df_test - df_train.mean()))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Long-term Forecasts:  rmse=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">df_pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">series_id</span> <span class="o">+</span> <span class="s2">&quot; (multi-step forecasts)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Long-term Forecasts:  rmse=0.006085
</pre></div>
</div>
<img alt="_images/33a37ad5157148832af485caf01ab7deb1da47223f4679feb8107fd39a4e6676.png" src="_images/33a37ad5157148832af485caf01ab7deb1da47223f4679feb8107fd39a4e6676.png" />
</div>
</div>
</section>
<section id="granger-causality">
<h3>Granger causality<a class="headerlink" href="#granger-causality" title="Permalink to this heading">#</a></h3>
<p><strong>Granger causality</strong> tests whether past values of one time series help predict another.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Granger Causality: INDPRO vs CPI</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;INDPRO&#39;</span><span class="p">,</span> <span class="s1">&#39;CPIAUCSL&#39;</span><span class="p">]</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">19620101</span>
<span class="k">for</span> <span class="n">series_id</span><span class="p">,</span> <span class="n">exog_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">variables</span><span class="p">))):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">alf</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">series_id</span><span class="p">,</span> <span class="n">exog_id</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Null Hypothesis: </span><span class="si">{</span><span class="n">exog_id</span><span class="si">}</span><span class="s2"> granger-causes </span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">dmf</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s1"> ~ </span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s1">.shift(1) &#39;</span>
           <span class="sa">f</span><span class="s1">&#39; + </span><span class="si">{</span><span class="n">exog_id</span><span class="si">}</span><span class="s1">.shift(1) &#39;</span>
           <span class="sa">f</span><span class="s1">&#39; + </span><span class="si">{</span><span class="n">exog_id</span><span class="si">}</span><span class="s1">.shift(2) &#39;</span>
           <span class="sa">f</span><span class="s1">&#39; + </span><span class="si">{</span><span class="n">exog_id</span><span class="si">}</span><span class="s1">.shift(3) &#39;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="n">dmf</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">robust</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_robustcov_results</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;HAC&#39;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxlags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">robust</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null Hypothesis: CPIAUCSL granger-causes INDPRO

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=0.4754  , p=0.4907  , df_denom=752, df_num=1
ssr based chi2 test:   chi2=0.4773  , p=0.4896  , df=1
likelihood ratio test: chi2=0.4772  , p=0.4897  , df=1
parameter F test:         F=0.4754  , p=0.4907  , df_denom=752, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=7.1786  , p=0.0008  , df_denom=749, df_num=2
ssr based chi2 test:   chi2=14.4530 , p=0.0007  , df=2
likelihood ratio test: chi2=14.3162 , p=0.0008  , df=2
parameter F test:         F=7.1786  , p=0.0008  , df_denom=749, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=5.4544  , p=0.0010  , df_denom=746, df_num=3
ssr based chi2 test:   chi2=16.5167 , p=0.0009  , df=3
likelihood ratio test: chi2=16.3381 , p=0.0010  , df=3
parameter F test:         F=5.4544  , p=0.0010  , df_denom=746, df_num=3

                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 INDPRO   R-squared:                       0.090
Model:                            OLS   Adj. R-squared:                  0.085
Method:                 Least Squares   F-statistic:                     2.729
Date:                Mon, 03 Mar 2025   Prob (F-statistic):             0.0283
Time:                        10:54:12   Log-Likelihood:                 2472.9
No. Observations:                 753   AIC:                            -4936.
Df Residuals:                     748   BIC:                            -4913.
Df Model:                           4                                         
Covariance Type:                  HAC                                         
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
Intercept             0.0019      0.001      1.993      0.047    2.94e-05       0.004
INDPRO.shift(1)       0.2553      0.141      1.817      0.070      -0.020       0.531
CPIAUCSL.shift(1)     0.4106      0.208      1.973      0.049       0.002       0.819
CPIAUCSL.shift(2)    -0.4210      0.193     -2.178      0.030      -0.800      -0.042
CPIAUCSL.shift(3)    -0.1652      0.134     -1.228      0.220      -0.429       0.099
==============================================================================
Omnibus:                      721.664   Durbin-Watson:                   1.981
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           120296.612
Skew:                          -3.763   Prob(JB):                         0.00
Kurtosis:                      64.462   Cond. No.                         565.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 0 lags and without small sample correction
Null Hypothesis: INDPRO granger-causes CPIAUCSL

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=0.0450  , p=0.8321  , df_denom=752, df_num=1
ssr based chi2 test:   chi2=0.0452  , p=0.8317  , df=1
likelihood ratio test: chi2=0.0452  , p=0.8317  , df=1
parameter F test:         F=0.0450  , p=0.8321  , df_denom=752, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=0.0150  , p=0.9851  , df_denom=749, df_num=2
ssr based chi2 test:   chi2=0.0301  , p=0.9850  , df=2
likelihood ratio test: chi2=0.0301  , p=0.9850  , df=2
parameter F test:         F=0.0150  , p=0.9851  , df_denom=749, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=0.0926  , p=0.9641  , df_denom=746, df_num=3
ssr based chi2 test:   chi2=0.2804  , p=0.9637  , df=3
likelihood ratio test: chi2=0.2803  , p=0.9637  , df=3
parameter F test:         F=0.0926  , p=0.9641  , df_denom=746, df_num=3

                            OLS Regression Results                            
==============================================================================
Dep. Variable:               CPIAUCSL   R-squared:                       0.386
Model:                            OLS   Adj. R-squared:                  0.383
Method:                 Least Squares   F-statistic:                     51.93
Date:                Mon, 03 Mar 2025   Prob (F-statistic):           1.28e-38
Time:                        10:54:12   Log-Likelihood:                 3452.5
No. Observations:                 753   AIC:                            -6895.
Df Residuals:                     748   BIC:                            -6872.
Df Model:                           4                                         
Covariance Type:                  HAC                                         
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
Intercept             0.0012      0.000      6.847      0.000       0.001       0.002
CPIAUCSL.shift(1)     0.6210      0.046     13.623      0.000       0.532       0.711
INDPRO.shift(1)      -0.0021      0.014     -0.147      0.883      -0.030       0.025
INDPRO.shift(2)       0.0005      0.017      0.032      0.975      -0.032       0.033
INDPRO.shift(3)       0.0061      0.009      0.676      0.499      -0.012       0.024
==============================================================================
Omnibus:                       88.983   Durbin-Watson:                   2.119
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              750.324
Skew:                           0.030   Prob(JB):                    1.17e-163
Kurtosis:                       7.890   Cond. No.                         319.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 0 lags and without small sample correction
</pre></div>
</div>
</div>
</div>
</section>
<section id="impulse-response-function">
<h3>Impulse response function<a class="headerlink" href="#impulse-response-function" title="Permalink to this heading">#</a></h3>
<p><strong>Impulse response functions (IRF)</strong> analyze how shocks propagate through a system, often in <strong>Vector Autoregression (VAR)</strong> models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vector Autoregression: Impulse Response Function</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">irf</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#irf.plot(orth=False)</span>
<span class="n">irf</span><span class="o">.</span><span class="n">plot_cum_effects</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Summary of Regression Results   
==================================
Model:                         VAR
Method:                        OLS
Date:           Mon, 03, Mar, 2025
Time:                     10:54:12
--------------------------------------------------------------------
No. of Equations:         2.00000    BIC:                   -21.3411
Nobs:                     753.000    HQIC:                  -21.3939
Log likelihood:           5944.36    FPE:                4.94710e-10
AIC:                     -21.4270    Det(Omega_mle):     4.85639e-10
--------------------------------------------------------------------
Results for equation CPIAUCSL
==============================================================================
                 coefficient       std. error           t-stat            prob
------------------------------------------------------------------------------
const               0.000909         0.000139            6.528           0.000
L1.CPIAUCSL         0.544275         0.036383           14.960           0.000
L1.INDPRO           0.004382         0.009861            0.444           0.657
L2.CPIAUCSL         0.016181         0.041512            0.390           0.697
L2.INDPRO          -0.001898         0.010116           -0.188           0.851
L3.CPIAUCSL         0.147062         0.036710            4.006           0.000
L3.INDPRO           0.002953         0.009745            0.303           0.762
==============================================================================

Results for equation INDPRO
==============================================================================
                 coefficient       std. error           t-stat            prob
------------------------------------------------------------------------------
const               0.001899         0.000517            3.673           0.000
L1.CPIAUCSL         0.404130         0.135092            2.992           0.003
L1.INDPRO           0.270682         0.036614            7.393           0.000
L2.CPIAUCSL        -0.402895         0.154135           -2.614           0.009
L2.INDPRO          -0.066262         0.037563           -1.764           0.078
L3.CPIAUCSL        -0.182529         0.136306           -1.339           0.181
L3.INDPRO           0.083606         0.036182            2.311           0.021
==============================================================================

Correlation matrix of residuals
            CPIAUCSL    INDPRO
CPIAUCSL    1.000000  0.101927
INDPRO      0.101927  1.000000
</pre></div>
</div>
<img alt="_images/5dc1daaac21dce5c5a372f109199ef0a15f936ac92f8617aa7ef4c5eb0154d03.png" src="_images/5dc1daaac21dce5c5a372f109199ef0a15f936ac92f8617aa7ef4c5eb0154d03.png" />
<img alt="_images/5dc1daaac21dce5c5a372f109199ef0a15f936ac92f8617aa7ef4c5eb0154d03.png" src="_images/5dc1daaac21dce5c5a372f109199ef0a15f936ac92f8617aa7ef4c5eb0154d03.png" />
</div>
</div>
<p><strong>References:</strong></p>
<p>FRM Part I Exam Book Quantitative Analysis Ch 10-11</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2.2_regression_diagnostics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Linear Regression Diagonostics</p>
      </div>
    </a>
    <a class="right-next"
       href="2.4_approximate_factors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Approximate Factor Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonality">Seasonality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stationarity">Stationarity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation">Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-models">Time Series Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autoregressive-ar-models">Autoregressive (AR) models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-average-ma-models">Moving average (MA) models**</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arma-models">ARMA models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-lengths">Lag lengths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-component">Seasonal component</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-roots">Unit Roots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sarimax-model">SARIMAX model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting">Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ar-lag-order-selection">AR lag order selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-step-forecast">One-step forecast</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-step-forecast">Multi-step forecast</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#granger-causality">Granger causality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-response-function">Impulse response function</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Terence Lim
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>