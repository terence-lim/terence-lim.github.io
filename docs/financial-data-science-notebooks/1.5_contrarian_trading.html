

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Contrarian Trading &#8212; Financial Data Science Python Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1.5_contrarian_trading';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quant Factors" href="1.6_quant_factors.html" />
    <link rel="prev" title="Fama-Macbeth Cross-sectional Regressions" href="1.4_fama_macbeth.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
  
    <p class="title logo__title">Financial Data Science Python Notebooks</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    FINANCIAL DATA SCIENCE
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.1_stock_prices.html">Stock Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.2_jegadeesh_titman.html">Jegadeesh-Titman Rolling Portfolios</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.3_fama_french.html">Fama-French Portfolio Sorts</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.4_fama_macbeth.html">Fama-Macbeth Cross-sectional Regressions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Contrarian Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.6_quant_factors.html">Quant Factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.7_event_study.html">Event Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.1_economic_indicators.html">Economic Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.2_regression_diagnostics.html">Linear Regression Diagonostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.3_time_series.html">Time Series Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.4_approximate_factors.html">Approximate Factor Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.5_economic_states.html">State Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.1_term_structure.html">Term Structure of Interest Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.2_bond_returns.html">Interest Rate Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.3_options_pricing.html">Options Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.4_value_at_risk.html">Value at Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.5_covariance_matrix.html">Covariance Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.6_market_microstructure.html">Market Microstructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.7_event_risk.html">Event Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.1_network_graphs.html">Supply Chain Network Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.2_community_detection.html">Industry Community Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.3_graph_centrality.html">Input-Output Graph Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.4_link_prediction.html">Product Market Link Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.5_spatial_regression.html">Earnings Spatial Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.1_fomc_topics.html">FOMC Topic Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.2_management_sentiment.html">Management Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.3_business_textual.html">Business Textual Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.1_classification_models.html">Machine Learning: Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.2_regression_models.html">Machine Learning: Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.3_deep_learning.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.4_convolutional_net.html">Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.5_recurrent_net.html">Recurrent Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.6_reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.7_language_modeling.html">Language Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.1_large_language_models.html">Large Language Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.2_llm_finetuning.html">LLM Fine-tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.3_llm_prompting.html">LLM Prompting</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.4_llm_agents.html">LLM Agents</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/terence-lim/financial-data-science-notebooks.git" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/terence-lim/financial-data-science-notebooks.git/issues/new?title=Issue%20on%20page%20%2F1.5_contrarian_trading.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/1.5_contrarian_trading.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Contrarian Trading</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-reversion">Mean reversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-shortfall">Implementation shortfall</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-break-with-unknown-changepoint">Structural break with unknown changepoint</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-evaluation">Performance evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-coefficient">Information coefficient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#risk-adjusted-performance-measures">Risk-adjusted performance measures</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="contrarian-trading">
<h1>Contrarian Trading<a class="headerlink" href="#contrarian-trading" title="Permalink to this heading">#</a></h1>
<p><em>Fortune befriends the bold</em> - Emily Dickinson</p>
<p>Contrarian trading strategies are based on the premise of mean reversion, which posits that asset prices tend to revert to their long-term average over time. This idea is integral to various investment strategies, as it suggests that prices that have deviated significantly from historical norms will eventually return to their equilibrium levels. In these strategies, mispricing can occur due to investor overreaction, leading to temporary opportunities for profitable trades. Common approaches, such as pairs trading and statistical arbitrage, capitalize on these price deviations by simultaneously taking opposing positions in correlated assets. This analysis examines the construction of a contrarian trading strategy, evaluates its performance using key risk-adjusted metrics like the Sharpe ratio, and assesses the effects of implementation shortfall and structural breaks in the strategy’s effectiveness over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="k">as</span> <span class="nn">ro</span>
<span class="kn">from</span> <span class="nn">rpy2.robjects.packages</span> <span class="kn">import</span> <span class="n">importr</span>
<span class="kn">from</span> <span class="nn">finds.database</span> <span class="kn">import</span> <span class="n">SQL</span><span class="p">,</span> <span class="n">RedisDB</span>
<span class="kn">from</span> <span class="nn">finds.structured</span> <span class="kn">import</span> <span class="n">BusDay</span><span class="p">,</span> <span class="n">CRSP</span><span class="p">,</span> <span class="n">Benchmarks</span>
<span class="kn">from</span> <span class="nn">finds.recipes</span> <span class="kn">import</span> <span class="n">fractile_split</span><span class="p">,</span> <span class="n">least_squares</span>
<span class="kn">from</span> <span class="nn">finds.utils</span> <span class="kn">import</span> <span class="n">PyR</span><span class="p">,</span> <span class="n">row_formatted</span>
<span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">credentials</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">CRSP_DATE</span>
<span class="n">VERBOSE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#%matplotlib qt</span>

<span class="n">importr</span><span class="p">(</span><span class="s1">&#39;strucchange&#39;</span><span class="p">)</span>   <span class="c1"># R package to use</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rpy2.robjects.packages.Package as a &lt;module &#39;strucchange&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open connections</span>
<span class="n">sql</span> <span class="o">=</span> <span class="n">SQL</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;sql&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">rdb</span> <span class="o">=</span> <span class="n">RedisDB</span><span class="p">(</span><span class="o">**</span><span class="n">credentials</span><span class="p">[</span><span class="s1">&#39;redis&#39;</span><span class="p">])</span>
<span class="n">bd</span> <span class="o">=</span> <span class="n">BusDay</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">crsp</span> <span class="o">=</span> <span class="n">CRSP</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">bd</span><span class="p">,</span> <span class="n">rdb</span><span class="o">=</span><span class="n">rdb</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">bench</span> <span class="o">=</span> <span class="n">Benchmarks</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">bd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="mean-reversion">
<h2>Mean reversion<a class="headerlink" href="#mean-reversion" title="Permalink to this heading">#</a></h2>
<p>The concept of <strong>mean reversion</strong> forms the foundation of many trading strategies. According to the <strong>law of one price</strong>, similar assets should be priced similarly. When this does not hold, traders can exploit the mispricing through <strong>arbitrage</strong> by buying undervalued assets and short-selling overvalued ones, causing the prices to converge. Deviations from expected long-term values, such as yield spreads in fixed income assets, are typically not persistent. <strong>Pairs trading</strong> involves selecting two related securities and trading them to profit from their temporary price divergences. Meanwhile, <strong>statistical arbitrage</strong> (or <strong>stat arb</strong>) relies on complex algorithms to identify and exploit statistical relationships between securities. Although these relationships are not risk-free, stat arb strategies diversify across numerous positions to reduce exposure to risk. However, correlations between asset classes often increase during financial crises due to liquidity constraints and deleveraging, complicating risk management.</p>
<p>We evaluate a <strong>contrarian strategy</strong> based on weekly returns of US stocks, driven by the idea that stock mispricing arises from investor overreaction, as discussed by Lo and Mackinlay (1990). The <strong>alpha</strong> of this strategy can be measured by its <strong>information coefficient</strong> and <strong>volatility</strong> components, as outlined by Grinold (1994). To examine the strategy’s effectiveness over time, we apply tests for <strong>structural breaks</strong> with unknown change points. A key consideration in this analysis is the discrepancy between theoretical portfolio returns, based on assumed execution at decision prices, and actual returns, influenced by factors such as trading costs. The concept of <strong>implementation shortfall</strong> (introduced by Perold in 1988) captures the total cost of executing an investment decision, accounting for both explicit and implicit costs like market impact and opportunity costs.</p>
<p><strong>Weekly returns reversals</strong></p>
<p>Daily returns from CRSP are compounded in to weekly stock returns assuming Wednesday-close to Wednesday-close. This skips over weekend and holiday (which often occur over a long weekend) effects. The backtest starts in January 1974, after an expansion of the stocks universe the previous year, and excludes the smallest market cap quintile (based on NYSE breakpoints) comprising microcap stocks.</p>
<p>Let <span class="math notranslate nohighlight">\(\overline{r}_{t}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{t}\)</span> be the
cross-sectional mean and standard deviation of stock returns in week
<span class="math notranslate nohighlight">\(t\)</span>. Define <span class="math notranslate nohighlight">\(\tilde{r}_t = r_t - \overline{r}_t\)</span> as the vector of
demeaned stock returns, and <span class="math notranslate nohighlight">\(X_{t} = -\tilde{r}_t / \sigma_t\)</span> as the
vector of normalized scores. In other words, stocks’ “exposures” to (minus) their respective prior week’s returns are standardized to have cross-sectional variance and standard deviation equal to 1.0.</p>
<p>Each week, a portfolio is rebalanced to hold an amount in each stock equal to their respective exposure values divided by the number of holdings <span class="math notranslate nohighlight">\(w_{t} = X_{t}/n\)</span>.  hence the portfolio overall has unit exposure to prior week’s returns <span class="math notranslate nohighlight">\(w_{t}^TX_{t} = 1\)</span> and is dollar-neutral <span class="math notranslate nohighlight">\(\sum w_{t} = \sum X_{t}/n = 0\)</span>.</p>
<p>This portfolio construction approach can more generally incorporate additional signals where <span class="math notranslate nohighlight">\(X\)</span> may be a matrix with ones in the
first column and standardized signal exposures in other columns. Then each row,
except the first, of <span class="math notranslate nohighlight">\(W = (X' X)^{-1} X'\)</span> contains stock weights
of a long-short characteristic porfolio: a dollar-neutral,
minimum-norm (in terms of squared weights) portfolio with unit
exposure through long positions in stocks with positive exposure and
short positions in stocks with negative exposure to the signal,
and zero exposure to the other characteristics.</p>
<p>The portfolio’s realized return in the following week <span class="math notranslate nohighlight">\(t+1\)</span> is</p>
<div class="math notranslate nohighlight">
\[W'_t ~ r_{t+1} = \dfrac{X'_t \tilde{r}_t}{n} + \dfrac{X'_t \hat{r}_t}{n} = -\dfrac{\tilde{r}'_t ~ \tilde{r}_{t+1} ~ \sigma_{t+1}} {n ~ \sigma_{t} ~ \sigma_{t+1}} =
-\rho_{t,t+1} ~ \sigma_{t+1}\]</div>
<p>that is the product of the
(negative) cross-sectional correlation of stock returns times the amount of cross-sectional stock volatility at week <span class="math notranslate nohighlight">\(t+1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekday</span> <span class="o">=</span> <span class="mi">3</span>          <span class="c1"># wednesday close-to-close</span>
<span class="n">bd</span> <span class="o">=</span> <span class="n">BusDay</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">endweek</span><span class="o">=</span><span class="n">weekday</span><span class="p">)</span>   <span class="c1"># Generate weekly cal</span>
<span class="n">begweek</span> <span class="o">=</span> <span class="mi">19740102</span>   <span class="c1"># increased stocks coverage in CRSP in Jan 1973</span>
<span class="n">endweek</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">endwk</span><span class="p">(</span><span class="n">CRSP_DATE</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rebaldates</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">begweek</span><span class="p">,</span> <span class="n">endweek</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;weekly&#39;</span><span class="p">)</span>
<span class="n">retdates</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">date_tuples</span><span class="p">(</span><span class="n">rebaldates</span><span class="p">)</span>

<span class="n">june_universe</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># to track date when reached a June end to update universe</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># to track new year to pre-load stocks datas in batch by year</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lagged_weights</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># to track &quot;turnover&quot; of stock weights</span>
<span class="k">for</span> <span class="n">rebaldate</span><span class="p">,</span> <span class="n">pastdates</span><span class="p">,</span> <span class="n">nextdates</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
        <span class="n">rebaldates</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">retdates</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">retdates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">rebaldates</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1"># screen universe each June: largest 5 size deciles</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">june_universe</span><span class="p">(</span><span class="n">rebaldate</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">!=</span> <span class="n">june_universe</span><span class="p">:</span>  <span class="c1"># need next June&#39;s universe</span>
        <span class="n">june_universe</span> <span class="o">=</span> <span class="n">d</span>                        <span class="c1"># update universe every June</span>
        <span class="n">univ</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_universe</span><span class="p">(</span><span class="n">june_universe</span><span class="p">)</span>  <span class="c1"># usual CRSP universe screen</span>
        <span class="n">univ</span> <span class="o">=</span> <span class="n">univ</span><span class="p">[</span><span class="n">univ</span><span class="p">[</span><span class="s1">&#39;decile&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">]</span>         <span class="c1"># drop smallest quintile stocks</span>

    <span class="c1"># retrieve new annual batch of daily prices and returns when start new year</span>
    <span class="k">if</span> <span class="n">bd</span><span class="o">.</span><span class="n">begyr</span><span class="p">(</span><span class="n">rebaldate</span><span class="p">)</span> <span class="o">!=</span> <span class="n">year</span><span class="p">:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">begyr</span><span class="p">(</span><span class="n">rebaldate</span><span class="p">)</span>
        <span class="n">prc</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span>
                             <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bidlo&#39;</span><span class="p">,</span> <span class="s1">&#39;askhi&#39;</span><span class="p">,</span> <span class="s1">&#39;prc&#39;</span><span class="p">,</span> <span class="s1">&#39;retx&#39;</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">],</span>
                             <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span>
                             <span class="n">beg</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
                             <span class="n">end</span><span class="o">=</span><span class="n">bd</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">bd</span><span class="o">.</span><span class="n">endyr</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span>
                             <span class="n">cache_mode</span><span class="o">=</span><span class="s2">&quot;rw&quot;</span><span class="p">)</span>

    <span class="c1"># get past week&#39;s returns, require price at rebalance (decision) date</span>
    <span class="n">past_week</span> <span class="o">=</span> <span class="n">prc</span><span class="p">[</span><span class="n">prc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">rebaldate</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;permno&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">crsp</span><span class="o">.</span><span class="n">get_ret</span><span class="p">(</span><span class="o">*</span><span class="n">pastdates</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">univ</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>\
        <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># convert past week&#39;s returns to desired standardized portfolio weights</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">((</span><span class="n">past_week</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">past_week</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">])</span> <span class="o">/</span>
               <span class="p">(</span><span class="n">past_week</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">past_week</span><span class="p">)))</span>

    <span class="c1"># adjust past week&#39;s holdings by change stock price</span>
    <span class="n">lagged_weights</span> <span class="o">=</span> <span class="n">lagged_weights</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">crsp</span><span class="o">.</span><span class="n">get_ret</span><span class="p">(</span><span class="o">*</span><span class="n">pastdates</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;retx&#39;</span><span class="p">)</span>\
                                        <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">lagged_weights</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>\
                                        <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># compute how much to buy (or sell) to achieve desired new portfolio weights</span>
    <span class="n">chg_weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">weights</span><span class="p">,</span> <span class="o">-</span><span class="n">lagged_weights</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># calculate total abs weight as denominator for scaling turnover</span>
    <span class="n">total_weight</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">lagged_weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># get next week&#39;s gross returns</span>
    <span class="n">next_week</span> <span class="o">=</span> <span class="n">crsp</span><span class="o">.</span><span class="n">get_ret</span><span class="p">(</span><span class="o">*</span><span class="n">nextdates</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># get next day&#39;s prices to compute one-day slippage cost</span>
    <span class="n">next_day</span> <span class="o">=</span> <span class="n">prc</span><span class="p">[</span><span class="n">prc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span> <span class="o">==</span>
                   <span class="n">bd</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">rebaldate</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>\
                   <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
                   <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;permno&#39;</span><span class="p">)</span>\
                   <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>\
                   <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">chg_weights</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># if no trade next day, then enter position at askhi (buy) or bidlo (sell)</span>
    <span class="n">bidask</span> <span class="o">=</span> <span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;askhi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">chg_weights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;bidlo&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="c1"># spread is relevant askhi or bidlo divided by recorded close, minus 1</span>
    <span class="n">spread</span> <span class="o">=</span> <span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bidask</span><span class="p">)</span>\
                            <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>\
                            <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>\
                            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># finally, trade_prc is the next day&#39;s close, or the relevent askhi or bidlo</span>
    <span class="n">trade_prc</span> <span class="o">=</span> <span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bidask</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># drift is next day&#39;s trade price with dividends over today&#39;s decision price</span>
    <span class="c1"># delay (positive is cost) will be chg_weights * drift </span>
    <span class="n">drift</span> <span class="o">=</span> <span class="n">trade_prc</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>\
                     <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">])</span>\
                     <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>\
                     <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    

    <span class="c1"># exit and enter delay should sum to chg_weights.dot(next_day[&#39;ret&#39;])</span>
    <span class="n">exit1</span> <span class="o">=</span> <span class="o">-</span><span class="n">lagged_weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">lagged_weights</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">enter1</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1"># accumulate weekly calculations</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;ret&#39;</span><span class="p">:</span> <span class="n">weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">next_week</span><span class="p">),</span>
         <span class="s1">&#39;exit1&#39;</span><span class="p">:</span> <span class="n">exit1</span><span class="p">,</span>
         <span class="s1">&#39;enter1&#39;</span><span class="p">:</span> <span class="n">enter1</span><span class="p">,</span>
         <span class="s1">&#39;delay&#39;</span><span class="p">:</span> <span class="n">chg_weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">next_day</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>  <span class="c1"># delay=enter+exit</span>
         <span class="s1">&#39;spread&#39;</span><span class="p">:</span> <span class="n">chg_weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">spread</span><span class="p">),</span>
         <span class="s1">&#39;slippage&#39;</span><span class="p">:</span> <span class="n">chg_weights</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drift</span><span class="p">),</span> <span class="c1"># total slippage</span>
         <span class="s1">&#39;ic&#39;</span><span class="p">:</span> <span class="n">weights</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">next_week</span><span class="p">),</span>
         <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_week</span><span class="p">),</span>
         <span class="s1">&#39;beg&#39;</span><span class="p">:</span> <span class="n">nextdates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">nextdates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
         <span class="s1">&#39;absweight&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()),</span>
         <span class="s1">&#39;turnover&#39;</span><span class="p">:</span> <span class="n">chg_weights</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">total_weight</span><span class="p">,</span>
         <span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">next_week</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)},</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">rebaldate</span><span class="p">]))</span>

    <span class="c1"># carry forward to next week as lagged portfolio weights</span>
    <span class="n">lagged_weights</span> <span class="o">=</span> <span class="n">weights</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████▉| 2659/2660 [01:29&lt;00:00, 29.74it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine accumulated computations and report</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;net&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;slippage&#39;</span><span class="p">])</span>
<span class="c1"># Show summary</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ic&#39;</span> <span class="p">,</span><span class="s1">&#39;vol&#39;</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;slippage&#39;</span><span class="p">,</span> <span class="s1">&#39;net&#39;</span><span class="p">,</span> <span class="s1">&#39;exit1&#39;</span><span class="p">,</span> <span class="s1">&#39;enter1&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span>
        <span class="s1">&#39;spread&#39;</span><span class="p">,</span> <span class="s1">&#39;turnover&#39;</span><span class="p">]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Information coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;Cross-sectional Volatility&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Gross return (alpha)&#39;</span><span class="p">,</span> <span class="s1">&#39;Slippage cost&#39;</span><span class="p">,</span> <span class="s1">&#39;Net (of slippage) return&#39;</span><span class="p">,</span>
           <span class="s1">&#39;   Exit one day delay   &#39;</span><span class="p">,</span> <span class="s1">&#39;   Enter one day delay   &#39;</span><span class="p">,</span> <span class="s1">&#39;Delay cost&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Spread cost&#39;</span><span class="p">,</span> <span class="s1">&#39;Portfolio turnover&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Summary of Weekly Mean Reversion Strategy </span><span class="si">{</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">dates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">),</span>
           <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
  <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">indexes</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summary of Weekly Mean Reversion Strategy 19740109-20241218
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Information coefficient</th>
      <td>0.0376</td>
      <td>0.1022</td>
    </tr>
    <tr>
      <th>Cross-sectional Volatility</th>
      <td>0.0536</td>
      <td>0.0191</td>
    </tr>
    <tr>
      <th>Gross return (alpha)</th>
      <td>0.0021</td>
      <td>0.0080</td>
    </tr>
    <tr>
      <th>Slippage cost</th>
      <td>0.0017</td>
      <td>0.0047</td>
    </tr>
    <tr>
      <th>Net (of slippage) return</th>
      <td>0.0005</td>
      <td>0.0078</td>
    </tr>
    <tr>
      <th>Exit one day delay</th>
      <td>-0.0003</td>
      <td>0.0029</td>
    </tr>
    <tr>
      <th>Enter one day delay</th>
      <td>0.0006</td>
      <td>0.0036</td>
    </tr>
    <tr>
      <th>Delay cost</th>
      <td>0.0004</td>
      <td>0.0041</td>
    </tr>
    <tr>
      <th>Spread cost</th>
      <td>0.0013</td>
      <td>0.0023</td>
    </tr>
    <tr>
      <th>Portfolio turnover</th>
      <td>0.7363</td>
      <td>0.0407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="implementation-shortfall">
<h2>Implementation shortfall<a class="headerlink" href="#implementation-shortfall" title="Permalink to this heading">#</a></h2>
<p>Perold (1988) observed that the a paper portfolio based upon a
well-known stock rankings system significantly outperformed the actual
track record of funds that make use of the system.  He defined
implementation shortfall as the difference in return between a
theoretical portfolio and the implemented portfolio, which captures explicit
fees and commissions as well as  market impact, delay and
opportunity costs.</p>
<ul class="simple">
<li><p><strong>Decision price</strong> is the price at the time the investment decision was
made</p></li>
<li><p><strong>Arrival price</strong> is the midquote (mid-point of bid-ask prices) at the
time the trader, broker or trading system received the order, or the
trade decision is made.</p></li>
<li><p><strong>Market drift</strong> is the amount of buys (sells) multiplied
by the increase (decrease) in execution price relative to the
arrival price, due to execution delay.</p></li>
<li><p><strong>Delay</strong> is the adverse change in execution price relative to the decision price</p></li>
<li><p><strong>Opportunity costs</strong> are the profits lost due to trades that are cancelled or not executed.</p></li>
<li><p><strong>Market impact costs</strong> are bid-ask spreads as well as the amount that buying or selling moves the price against the buyer or seller</p></li>
</ul>
<p>The <strong>trader’s dilemma</strong> refers to the trade-off between market drift and
impact: one can trade faster with more impact to minimize market drift, or
trade slower to minimize market impact but at the risk of the market drifting
away.</p>
<p>In practice, stocks in the CRSP database are not available at finer than daily frequency, so we assume that trades are executed at the next day’s closing prices.</p>
<p>If stocks do not trade, we estimate execution prices based on bid-ask spreads. This approach helps address slippage and delays in execution, although transaction costs cannot be directly observed in historical backtests.</p>
<p>Unfortunately, stock prices in CRSP are not available at a finer than daily frequency. We adjust estimated profits for slippage by waiting a full day after the decision price then setting the execution price at the next day’s closing price, when stock market exchanges typically experience the most liquidity at the close of a trading dollar. For stocks that did not trade during that day, we assumed the desired buys are executed at the (higher) ask price and sells are executed at the (lower) bid price (in CRSP for such cases, closing bid and ask quotes are recorded and the closing price is set to the negative of the bid-ask average). This approach helps address slippage and delays in execution, although transaction costs cannot be directly observed in historical backtests.</p>
<p>Over the full period, much of the profitability of this version of the strategy appears to be dissipated after considering a one-day execution delay and bid-ask spreads.</p>
</section>
<section id="structural-break-with-unknown-changepoint">
<h2>Structural break with unknown changepoint<a class="headerlink" href="#structural-break-with-unknown-changepoint" title="Permalink to this heading">#</a></h2>
<p>In a linear regression, the Chow test is commonly used to test for the presence of a structural break in the model at a period known <em>a priori</em>; it essentially constructs a test of whether the true coefficients on the independent variable split into two subsets are equal. Welch’s test that two populations have equal means is a special case with no independent variables and only an intercept whose true values are tested in the two time periods.  However, when the breakpoints are unknown, these standard tests are not applicable. Andrews (1993) and others have developed alternative tests, based on <em>supremum statistics</em>, for identifying changes in mean that occur at unknown points in the time series.</p>
<p>The <strong>R library</strong> <code class="docutils literal notranslate"><span class="pre">strucchange</span></code> provides tools for detecting structural breaks, and the <strong>rpy2</strong> Python package facilitates integration with R.  The <code class="docutils literal notranslate"><span class="pre">PyR</span></code> wrapper class in the FinDS package facilitates converting Pandas DataFrames to and from R objects and function calls.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Structural Break Test with Unknown Changepoint</span>


<span class="c1"># Set up data and formulas for R</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span>
<span class="n">formula</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">Formula</span><span class="p">(</span><span class="s1">&#39;y ~ 1&#39;</span><span class="p">)</span>
<span class="n">formula</span><span class="o">.</span><span class="n">environment</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PyR</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">ro</span>

<span class="c1"># Call R strucchange routines to compute breakpoint statistics</span>
<span class="n">fstats_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;Fstats&#39;</span><span class="p">](</span><span class="n">formula</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>    <span class="c1"># Fstats at every break</span>
<span class="n">breakpoints_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;breakpoints&#39;</span><span class="p">](</span><span class="n">formula</span><span class="p">)</span>         <span class="c1"># candidate breakpoints</span>
<span class="n">confint_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;confint&#39;</span><span class="p">](</span><span class="n">breakpoints_r</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># conf interval for 1 break</span>
<span class="n">sctest_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;sctest&#39;</span><span class="p">](</span><span class="n">fstats_r</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;aveF&#39;</span><span class="p">})</span>

<span class="c1"># Extract output from R results</span>
<span class="n">confint</span> <span class="o">=</span> <span class="n">PyR</span><span class="p">(</span><span class="n">confint_r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># R index starts at 1</span>

<span class="n">output</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">confint</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">confint</span><span class="p">]))</span>       <span class="c1"># confidence interval</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sctest_r</span><span class="o">.</span><span class="n">slots</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">],</span> <span class="n">sctest_r</span><span class="p">[:</span><span class="mi">3</span><span class="p">]):</span> <span class="c1"># significance values</span>
    <span class="n">output</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">PyR</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean(pre)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;breakpoints&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
<span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean(post)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;breakpoints&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">fstat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">PyR</span><span class="p">(</span><span class="n">fstats_r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># pad before and after</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Structural break test with unknown changepoint&quot;</span><span class="p">)</span>
<span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sctest&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Structural break test with unknown changepoint
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2.5 %</th>
      <th>breakpoints</th>
      <th>97.5 %</th>
      <th>statistic</th>
      <th>p.value</th>
      <th>method</th>
      <th>mean(pre)</th>
      <th>mean(post)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sctest</th>
      <td>1996-12-04</td>
      <td>2001-05-30</td>
      <td>2002-11-20</td>
      <td>17.588886</td>
      <td>0.0</td>
      <td>aveF test</td>
      <td>0.003112</td>
      <td>0.000969</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Plot breakpoint F-stats</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fstat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">argmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">fstat</span><span class="p">)</span>              <span class="c1"># where maximum fstat</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">argmax</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">confint</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">confint</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;F-stat&#39;</span><span class="p">,</span> <span class="s1">&#39;Max-F&#39;</span><span class="p">,</span> <span class="s1">&#39;C.I. of Break Date&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">argmax</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">argmax</span><span class="p">],</span> <span class="n">fstat</span><span class="p">[</span><span class="n">argmax</span><span class="p">]))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;F-statistic at Breakpoints&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date of Breakpoints&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Weekly Mean Reversion Structural Break F-stats&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1657351/3930510136.py:5: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  ax.axvspan(df.index[confint[0]], df.index[confint[2]], alpha=0.3, color=&#39;grey&#39;)
</pre></div>
</div>
<img alt="_images/2819836c7e607cb5433983e7f5bd13a8bc757ee793be917ea310476ad6b752ed.png" src="_images/2819836c7e607cb5433983e7f5bd13a8bc757ee793be917ea310476ad6b752ed.png" />
</div>
</div>
</section>
<section id="performance-evaluation">
<h2>Performance evaluation<a class="headerlink" href="#performance-evaluation" title="Permalink to this heading">#</a></h2>
<section id="information-coefficient">
<h3>Information coefficient<a class="headerlink" href="#information-coefficient" title="Permalink to this heading">#</a></h3>
<p>Grinold (1994) linked the expected alpha of a signal to its information coefficient and an asset’s signal score and idiosyncratic volatility: <span class="math notranslate nohighlight">\(\alpha = IC \times volatility \times score\)</span>.</p>
<ul class="simple">
<li><p><strong>IC</strong>: The information coefficient can be understood as
the correlation between a signal and residual returns.  It tells how well forecasts align wih actual returns and is a measure of manager forecasting skill.</p></li>
<li><p><strong>Volatility</strong>: The volatility can be understood as an asset’s residual risk. This component allows for forecast alpha to be expressed in units of returns.</p></li>
<li><p><strong>Score</strong>: The score is a standardized measure of an asset’s raw
signal exposure, and reflects relative expectations about an asset.
Standardization, by subtracing the cross-sectional mean and
dividing by the cross-sectional standard deviation, allows assets to be
compared to one another and over time.</p></li>
</ul>
<p>Recall that the weekly reversal portfolio <span class="math notranslate nohighlight">\(W_t\)</span> was constructed to be dollar-neutral with exposure equal to 1.0, with weekly profitability <span class="math notranslate nohighlight">\(W'_t ~ r_{t+1} = -\rho_{t,t+1} ~ \sigma_{t+1}\)</span>.  Hence the <strong>IC</strong> of this strategy can be computed using the negative cross-sectional correlation of stock returns over time. The rolling average of alpha and its components—information coefficient and volatility—reveal trends over the strategy’s life. The data show that while volatility fluctuated over time, the <strong>IC</strong> sharply declined after reaching a peak in the mid-1990s, continuing its downward trajectory through 2010.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Plot returns, and rolling avg information coefficient and cross-sectional vol</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;cumulative returns&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative returns&#39;</span><span class="p">)</span>
<span class="n">bx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">roll</span> <span class="o">=</span> <span class="mi">250</span>  <span class="c1"># 250 week rolling average ~ 5 years</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">bx</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;vol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">bx</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="c1">#bx.axhline(df[&#39;ic&#39;].mean(), linestyle=&#39;-&#39;, color=&#39;C0&#39;, lw=2)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bx</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;information coefficient (</span><span class="si">{</span><span class="n">roll</span><span class="si">}</span><span class="s2">-week average)&quot;</span><span class="p">,</span>
           <span class="sa">f</span><span class="s2">&quot;cross-sectional volatility (</span><span class="si">{</span><span class="n">roll</span><span class="si">}</span><span class="s2">-week average)&quot;</span><span class="p">],</span>
          <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Profitability of Weekly Mean Reversion </span><span class="si">{</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">dates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/899ebdc85a120cd432f13b0426dd3081066d7387b0283ba6846c1d166ba27be3.png" src="_images/899ebdc85a120cd432f13b0426dd3081066d7387b0283ba6846c1d166ba27be3.png" />
</div>
</div>
</section>
<section id="risk-adjusted-performance-measures">
<h3>Risk-adjusted performance measures<a class="headerlink" href="#risk-adjusted-performance-measures" title="Permalink to this heading">#</a></h3>
<p>In a CAPM equilibrium, no investor can achieve an abnormal return, and each investment yields an identical risk-adjusted return. In the real world, assets may yield a return in excess of, or below, that which fairly compensates for their risk exposure.  To assess the strategy’s risk-adjusted performance, we employ several key metrics:</p>
<ul class="simple">
<li><p>Sharpe ratio - slope of the capital market line is the fair equilibrium compensation: <span class="math notranslate nohighlight">\(\dfrac{R_P - r_f}{\sigma_P}\)</span></p></li>
<li><p>Treynor ratio - uses beta which is an approriate measure of risk for a well-diversified portfolio:  <span class="math notranslate nohighlight">\(\dfrac{R_P - r_f}{\beta_P}\)</span></p></li>
<li><p>Jensen’s alpha - the intercept of a CAPM regression should be zero in equilibrium:  <span class="math notranslate nohighlight">\(R_P - r_f- \beta_P(R_M - r_f)\)</span></p></li>
<li><p>Appraisal ratio - Jensen’s alpha scaled by the volatility of residual returns <span class="math notranslate nohighlight">\(\dfrac{\alpha}{\sigma_{P-M}}\)</span></p></li>
<li><p>Sortino ratio - focuses on downside risk relative a target required rate of return T: <span class="math notranslate nohighlight">\(\dfrac{R_P - T}{\sqrt{\sum_t \min(0, r_t - T)^2 / N}}\)</span></p></li>
<li><p>Information ratio - adjusts performance relative to a benchmark, called the acive return, scaled by the volatility of active returns, called tracking error: <span class="math notranslate nohighlight">\(\dfrac{\hat{R_P} - \hat{R_B}}{\sigma_{R_P-R_B}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(M^2\)</span> (Modigliani-squared) - imagines that the given portfolio, P, is mixed with a position in T-bills so that the resulting portfolio P* matches the volatility of the market portfolio. Because the market index and portfolio <span class="math notranslate nohighlight">\(P^*\)</span> have the same standard deviation, their performance may be compared by simply subtracting returns: <span class="math notranslate nohighlight">\(R_{P^*} - R_M\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">market</span> <span class="o">=</span> <span class="n">bench</span><span class="o">.</span><span class="n">get_series</span><span class="p">(</span><span class="n">permnos</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">],</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;ret&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="nb">breakpoint</span> <span class="o">=</span> <span class="n">BusDay</span><span class="o">.</span><span class="n">to_date</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;breakpoints&#39;</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">select</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">dates</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dates</span> <span class="o">&lt;=</span> <span class="nb">breakpoint</span><span class="p">,</span> <span class="n">dates</span> <span class="o">&gt;</span> <span class="nb">breakpoint</span><span class="p">],</span>
                          <span class="p">[</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="s1">&#39;Pre-break&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-break&#39;</span><span class="p">]):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">select</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">res</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">select</span><span class="p">]</span>

    <span class="c1"># align market returns and compute market regression beta</span>
    <span class="c1">#res[&#39;date&#39;] = res.index</span>
    <span class="n">res</span><span class="p">[</span><span class="s1">&#39;mkt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">market</span><span class="p">[</span><span class="n">market</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="o">*</span><span class="n">dt</span><span class="p">)][</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">res</span><span class="p">[[</span><span class="s1">&#39;beg&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="c1"># model = lm(res[&#39;mkt&#39;], res[&#39;ret&#39;], flatten=True)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mkt&#39;</span><span class="p">],</span> <span class="n">stdres</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># save df summary</span>
    <span class="n">out</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2"> Period&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;start date&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
        <span class="s1">&#39;end date&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
        <span class="s1">&#39;Sharpe Ratio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
        <span class="s1">&#39;Average Gross Return&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Std Dev Returns&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
        <span class="s1">&#39;Market Beta&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;Jensen Alpha (annualized)&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">52</span><span class="p">,</span>
        <span class="s1">&#39;Appraisal Ratio&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;Information Coefficient&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;ic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Cross-sectional Vol&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;vol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Total Slippage Cost&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;slippage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Spread Cost&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;spread&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Delay Cost&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;  Exit Delay Cost&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;exit1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;  Enter Delay Cost&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;enter1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Average Net Return&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;net&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;Portfolio Turnover&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;turnover&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="c1">#&#39;Abs Weight&#39;: res[&#39;absweight&#39;].mean(),</span>
        <span class="s1">&#39;Average Num Stocks&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display as formatted DataFrame</span>
<span class="n">fmts</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">([</span><span class="s1">&#39;start date&#39;</span><span class="p">,</span> <span class="s1">&#39;end date&#39;</span><span class="p">,</span> <span class="s1">&#39;Average Num Stocks&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subperiod Performance of Weekly Reversals&quot;</span><span class="p">)</span>
<span class="n">row_formatted</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">formats</span><span class="o">=</span><span class="n">fmts</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subperiod Performance of Weekly Reversals
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Full Period</th>
      <th>Pre-break Period</th>
      <th>Post-break Period</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>start date</th>
      <td>19740109</td>
      <td>19740109</td>
      <td>20010606</td>
    </tr>
    <tr>
      <th>end date</th>
      <td>20241218</td>
      <td>20010530</td>
      <td>20241218</td>
    </tr>
    <tr>
      <th>Sharpe Ratio</th>
      <td>1.9185</td>
      <td>3.6668</td>
      <td>0.7300</td>
    </tr>
    <tr>
      <th>Average Gross Return</th>
      <td>0.0021</td>
      <td>0.0031</td>
      <td>0.0010</td>
    </tr>
    <tr>
      <th>Std Dev Returns</th>
      <td>0.0080</td>
      <td>0.0061</td>
      <td>0.0096</td>
    </tr>
    <tr>
      <th>Market Beta</th>
      <td>0.0898</td>
      <td>0.0686</td>
      <td>0.1109</td>
    </tr>
    <tr>
      <th>Jensen Alpha (annualized)</th>
      <td>0.1030</td>
      <td>0.1566</td>
      <td>0.0407</td>
    </tr>
    <tr>
      <th>Appraisal Ratio</th>
      <td>1.8537</td>
      <td>3.6607</td>
      <td>0.6140</td>
    </tr>
    <tr>
      <th>Information Coefficient</th>
      <td>0.0376</td>
      <td>0.0578</td>
      <td>0.0140</td>
    </tr>
    <tr>
      <th>Cross-sectional Vol</th>
      <td>0.0536</td>
      <td>0.0542</td>
      <td>0.0529</td>
    </tr>
    <tr>
      <th>Total Slippage Cost</th>
      <td>0.0017</td>
      <td>0.0028</td>
      <td>0.0003</td>
    </tr>
    <tr>
      <th>Spread Cost</th>
      <td>0.0013</td>
      <td>0.0023</td>
      <td>0.0002</td>
    </tr>
    <tr>
      <th>Delay Cost</th>
      <td>0.0004</td>
      <td>0.0005</td>
      <td>0.0002</td>
    </tr>
    <tr>
      <th>Exit Delay Cost</th>
      <td>-0.0003</td>
      <td>-0.0004</td>
      <td>-0.0001</td>
    </tr>
    <tr>
      <th>Enter Delay Cost</th>
      <td>0.0006</td>
      <td>0.0010</td>
      <td>0.0002</td>
    </tr>
    <tr>
      <th>Average Net Return</th>
      <td>0.0005</td>
      <td>0.0003</td>
      <td>0.0006</td>
    </tr>
    <tr>
      <th>Portfolio Turnover</th>
      <td>0.7363</td>
      <td>0.7393</td>
      <td>0.7328</td>
    </tr>
    <tr>
      <th>Average Num Stocks</th>
      <td>1936</td>
      <td>1981</td>
      <td>1884</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The structural break test identified a statistically significant change in the strategy’s weekly returns around mid-2001. Comparing performance before and after this point reveals a clear decline in the annualized Sharpe ratio and average weekly returns, along with an increase in risk. This shift roughly coincides with the adoption of decimalization by the New York and American Stock Exchanges on January 29, 2001, which resulted in tighter bid-ask spreads. Prior to this change, U.S. markets quoted prices in fractions, with one-sixteenth (1/16) of a dollar being the smallest allowable price increment.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">R</span></code></strong> usage notes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ld</span><span class="p">:</span> <span class="n">cannot</span> <span class="n">find</span> <span class="o">-</span><span class="n">lgfortran</span>
<span class="n">collect2</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">ld</span> <span class="n">returned</span> <span class="mi">1</span> <span class="n">exit</span> <span class="n">status</span>
</pre></div>
</div>
<ul class="simple">
<li><p>check versions are the same: <code class="docutils literal notranslate"><span class="pre">gfortran</span> <span class="pre">--version</span></code> and <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">--version</span></code></p></li>
<li><p>select versions to be the same: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">update-alternatives</span> <span class="pre">--config</span> <span class="pre">gcc</span></code></p></li>
</ul>
<p><strong><strong>References</strong>:</strong></p>
<p>Andrews, D.W.K., “Tests for parameter instability and structural change with unknown change point”, Econometrica, 61 (1993), 821-856.</p>
<p>Grinold, Richard C., 1994, “Alpha is Volatility Times IC Times Score”, The Journal of Portfolio Management, Summer 1994, 20(4), 9-16</p>
<p>Lo, Andrew W. and MacKinlay, A. Craig, 1990, “When Are Contrarian Profits Due to Stock Market Overreaction?”, The Review of Financial Studies, 3(2), 175–205</p>
<p>Perold, Andre, 1988, “The Implementation Shortfall: Paper versus Reality”, The Journal of Portfolio Management, 14(3), 4-9</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1.4_fama_macbeth.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fama-Macbeth Cross-sectional Regressions</p>
      </div>
    </a>
    <a class="right-next"
       href="1.6_quant_factors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quant Factors</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-reversion">Mean reversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-shortfall">Implementation shortfall</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-break-with-unknown-changepoint">Structural break with unknown changepoint</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-evaluation">Performance evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-coefficient">Information coefficient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#risk-adjusted-performance-measures">Risk-adjusted performance measures</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Terence Lim
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>